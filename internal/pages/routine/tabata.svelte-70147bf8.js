import{C as ge,S as C,i as V,s as j,v as S,w as T,x as E,F,p as d,n as g,A as I,L as P,O as J,X as M,e as A,j as O,c as W,a as L,l as K,d as $,b as N,f as w,E as D,J as Q,R as he,U as be,V as $e,W as ve,k as G,m as H,o as q,H as x,P as X,t as ke,g as ye,h as Re,Q as ee,G as te,T as ne,a2 as Se,a1 as Te,u as Ee}from"../../chunks/vendor-a6521ad7.js";import{g as Ie}from"../../chunks/navigation-c71191e7.js";import{A as Y,S as se,L as we}from"../../chunks/appStore-ff2f2670.js";import{r as h,R as U,E as Be}from"../../chunks/exerciseCard-c5bca8bb.js";import{V as Z,s as re}from"../../chunks/helpers-3dc73931.js";import{F as Pe,L as z,M as Oe,I as Ke,P as Ce}from"../../chunks/playPauseToggleIcon-1b3930ec.js";import{T as Ve}from"../../chunks/TimeKeeper-21e41350.js";import"../../chunks/singletons-a42a5e91.js";const je=()=>{const{subscribe:o,set:e,update:s}=ge([]),t=r=>{e(n(r.meta,r.exercises))},n=(r,l)=>{let f=[];for(let c=0;c<r.tabatas;c++)if(l.forEach((p,_)=>{const v=Object.assign({cycle:_+1,round:c+1,elapsed:0,duration:r.time_on},p);if(v.type=h.WORK,f.push(U(v)),_<l.length-1){const k={name:"Rest",display_name:"Rest",type:h.REST,cycle:_+1,round:c+1,elapsed:0,duration:r.time_off};f.push(U(k))}}),c<r.tabatas-1){const p={name:"Break",display_name:"Break",type:h.BREAK,cycle:0,round:c+2,elapsed:0,duration:r.rest_time};f.push(U(p))}return f.unshift(U({name:"Prepare",display_name:"Prep",type:h.PREP,cycle:0,round:0,elapsed:0,duration:r.prep_time})),f};return{subscribe:o,set:e,update:s,setWorkout:t,reset:()=>{s(r=>r.map(l=>(l.elapsed=0,l)))},isComplete:()=>{let r=!1;return s(l=>(r=Boolean(l.length)&&l.every(f=>f.elapsed===f.duration),l)),r},hasStarted:()=>{let r=!1;return o(f=>{f.length&&(r=f[0].elapsed>0)})(),r}}};var R=je();function Ae(o){let e,s;return e=new Pe({props:{id:"tabataSettingsForm",title:"Tabata Settings",fieldsets:o[1]()}}),e.$on("change",o[2]),e.$on("submit",o[3]),e.$on("click",o[4]),{c(){S(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){E(e,t,n),s=!0},p:F,i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function We(o,e,s){let t,n;P(o,R,f=>s(7,n=f));const a=Y.userSettings;P(o,a,f=>s(6,t=f));const i=()=>{const f=n.find(k=>k.type===h.PREP),c=n.find(k=>k.type===h.WORK),p=n.find(k=>k.type===h.REST),_=n.find(k=>k.type===h.BREAK);return[{legend:"Runtime",inputs:[{id:"prep_time",name:"PREP",value:f?f.duration:0,label:"Prep Time (seconds)",type:"number"},{id:"time_on",name:"WORK",value:c?c.duration:0,label:"Exercise Time (seconds)",type:"number"},{id:"time_off",name:"REST",value:p?p.duration:0,label:"Rest Time (seconds)",type:"number"},{id:"rest_time",name:"BREAK",value:_?_.duration:0,label:"Break Time (seconds)",type:"number"},{id:"use_voice",name:"use_voice",checked:t.use_voice,label:"Use Voice?",type:"slider"},{id:"preferred_voice",name:"preferred_voice",value:t.preferred_voice,label:"Preferred Voice",type:"select",placeholder:"Available Voices",options:Z.getVoices(null,!0)}]}]},u=f=>{switch(f.currentTarget.name){case"PREP":case"WORK":case"REST":case"BREAK":const c=parseInt(f.currentTarget.value);isNaN(c)||R.update(p=>(p.forEach((_,v)=>{_.type===h[f.currentTarget.name]&&p[v].elapsed!==p[v].duration&&(p[v].duration=c)}),p));break;case"use_voice":J(a,t.use_voice=f.currentTarget.checked,t);break;case"preferred_voice":J(a,t.preferred_voice=f.currentTarget.value,t),Z.defaultVoice=t.preferred_voice;break}};function r(f){M.call(this,o,f)}function l(f){M.call(this,o,f)}return[a,i,u,r,l]}class Le extends C{constructor(e){super();V(this,e,We,Ae,j,{})}}function Ne(o){let e,s,t,n,a,i,u,r,l;return s=new z({props:{label:"Elapsed",value:o[0]}}),n=new z({props:{label:"Remaining",value:o[1]}}),i=new z({props:{label:"Cycles",value:o[2]}}),r=new z({props:{label:"Tabatas",value:o[3]}}),{c(){e=A("div"),S(s.$$.fragment),t=O(),S(n.$$.fragment),a=O(),S(i.$$.fragment),u=O(),S(r.$$.fragment),this.h()},l(f){e=W(f,"DIV",{class:!0});var c=L(e);T(s.$$.fragment,c),t=K(c),T(n.$$.fragment,c),a=K(c),T(i.$$.fragment,c),u=K(c),T(r.$$.fragment,c),c.forEach($),this.h()},h(){N(e,"class","svelte-1ujgwto")},m(f,c){w(f,e,c),E(s,e,null),D(e,t),E(n,e,null),D(e,a),E(i,e,null),D(e,u),E(r,e,null),l=!0},p(f,[c]){const p={};c&1&&(p.value=f[0]),s.$set(p);const _={};c&2&&(_.value=f[1]),n.$set(_);const v={};c&4&&(v.value=f[2]),i.$set(v);const k={};c&8&&(k.value=f[3]),r.$set(k)},i(f){l||(d(s.$$.fragment,f),d(n.$$.fragment,f),d(i.$$.fragment,f),d(r.$$.fragment,f),l=!0)},o(f){g(s.$$.fragment,f),g(n.$$.fragment,f),g(i.$$.fragment,f),g(r.$$.fragment,f),l=!1},d(f){f&&$(e),I(s),I(n),I(i),I(r)}}}function De(o,e,s){let t="00:00",n="00:00",a="0/0",i="0/0";const u=R.subscribe(r=>{if(!r.length)return;const l=r.reduce((p,_)=>p+_.elapsed,0),f=r.reduce((p,_)=>p+_.duration,0),c=r.findIndex(p=>p.elapsed<p.duration);s(0,t=re(l)),s(1,n=re(f-l)),s(2,a=r[c].cycle+"/"+r[r.length-1].cycle),s(3,i=r[c].round+"/"+r[r.length-1].round)});return Q(()=>u()),[t,n,a,i]}class Fe extends C{constructor(e){super();V(this,e,De,Ne,j,{})}}function Ge(o){let e,s;const t=o[1].default,n=he(t,o,o[0],null);return{c(){e=A("div"),n&&n.c(),this.h()},l(a){e=W(a,"DIV",{class:!0});var i=L(e);n&&n.l(i),i.forEach($),this.h()},h(){N(e,"class","svelte-1t55ahf")},m(a,i){w(a,e,i),n&&n.m(e,null),s=!0},p(a,[i]){n&&n.p&&(!s||i&1)&&be(n,t,a,a[0],s?ve(t,a[0],i,null):$e(a[0]),null)},i(a){s||(d(n,a),s=!0)},o(a){g(n,a),s=!1},d(a){a&&$(e),n&&n.d(a)}}}function He(o,e,s){let{$$slots:t={},$$scope:n}=e;return o.$$set=a=>{"$$scope"in a&&s(0,n=a.$$scope)},[n,t]}class qe extends C{constructor(e){super();V(this,e,He,Ge,j,{})}}function ae(o,e,s){const t=o.slice();return t[6]=e[s],t}function le(o,e,s){const t=o.slice();return t[9]=e[s],t}function Ue(o){let e,s;return e=new Be({props:{name:o[9].display_name,completed:o[9].duration===o[9].elapsed,region:o[9].region,target:o[9].target,band_pos:o[9].band_pos,band_pos_text:o[9].band_pos_text}}),{c(){S(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){E(e,t,n),s=!0},p(t,n){const a={};n&2&&(a.name=t[9].display_name),n&2&&(a.completed=t[9].duration===t[9].elapsed),n&2&&(a.region=t[9].region),n&2&&(a.target=t[9].target),n&2&&(a.band_pos=t[9].band_pos),n&2&&(a.band_pos_text=t[9].band_pos_text),e.$set(a)},i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function ze(o){let e,s=o[9].display_name+"",t;return{c(){e=A("h2"),t=ke(s),this.h()},l(n){e=W(n,"H2",{class:!0});var a=L(e);t=ye(a,s),a.forEach($),this.h()},h(){N(e,"class","rest-item svelte-n7t0x8")},m(n,a){w(n,e,a),D(e,t)},p(n,a){a&2&&s!==(s=n[9].display_name+"")&&Re(t,s)},i:F,o:F,d(n){n&&$(e)}}}function oe(o){let e,s,t,n;const a=[ze,Ue],i=[];function u(r,l){return r[9].type!==h.WORK?0:1}return e=u(o),s=i[e]=a[e](o),{c(){s.c(),t=G()},l(r){s.l(r),t=G()},m(r,l){i[e].m(r,l),w(r,t,l),n=!0},p(r,l){let f=e;e=u(r),e===f?i[e].p(r,l):(H(),g(i[f],1,1,()=>{i[f]=null}),q(),s=i[e],s?s.p(r,l):(s=i[e]=a[e](r),s.c()),d(s,1),s.m(t.parentNode,t))},i(r){n||(d(s),n=!0)},o(r){g(s),n=!1},d(r){i[e].d(r),r&&$(t)}}}function ie(o){let e,s,t,n=o[6],a=[];for(let u=0;u<n.length;u+=1)a[u]=oe(le(o,n,u));const i=u=>g(a[u],1,1,()=>{a[u]=null});return{c(){e=A("li");for(let u=0;u<a.length;u+=1)a[u].c();s=O(),this.h()},l(u){e=W(u,"LI",{class:!0});var r=L(e);for(let l=0;l<a.length;l+=1)a[l].l(r);s=K(r),r.forEach($),this.h()},h(){N(e,"class","svelte-n7t0x8")},m(u,r){w(u,e,r);for(let l=0;l<a.length;l+=1)a[l].m(e,null);D(e,s),t=!0},p(u,r){if(r&6){n=u[6];let l;for(l=0;l<n.length;l+=1){const f=le(u,n,l);a[l]?(a[l].p(f,r),d(a[l],1)):(a[l]=oe(f),a[l].c(),d(a[l],1),a[l].m(e,s))}for(H(),l=n.length;l<a.length;l+=1)i(l);q()}},i(u){if(!t){for(let r=0;r<n.length;r+=1)d(a[r]);t=!0}},o(u){a=a.filter(Boolean);for(let r=0;r<a.length;r+=1)g(a[r]);t=!1},d(u){u&&$(e),x(a,u)}}}function Je(o){let e,s,t=o[2](o[1]),n=[];for(let i=0;i<t.length;i+=1)n[i]=ie(ae(o,t,i));const a=i=>g(n[i],1,1,()=>{n[i]=null});return{c(){e=A("ol");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=W(i,"OL",{class:!0});var u=L(e);for(let r=0;r<n.length;r+=1)n[r].l(u);u.forEach($),this.h()},h(){N(e,"class","svelte-n7t0x8")},m(i,u){w(i,e,u);for(let r=0;r<n.length;r+=1)n[r].m(e,null);o[4](e),s=!0},p(i,u){if(u&6){t=i[2](i[1]);let r;for(r=0;r<t.length;r+=1){const l=ae(i,t,r);n[r]?(n[r].p(l,u),d(n[r],1)):(n[r]=ie(l),n[r].c(),d(n[r],1),n[r].m(e,null))}for(H(),r=t.length;r<n.length;r+=1)a(r);q()}},i(i){if(!s){for(let u=0;u<t.length;u+=1)d(n[u]);s=!0}},o(i){n=n.filter(Boolean);for(let u=0;u<n.length;u+=1)g(n[u]);s=!1},d(i){i&&$(e),x(n,i),o[4](null)}}}function Qe(o){let e,s;return e=new qe({props:{$$slots:{default:[Je]},$$scope:{ctx:o}}}),{c(){S(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){E(e,t,n),s=!0},p(t,[n]){const a={};n&4099&&(a.$$scope={dirty:n,ctx:t}),e.$set(a)},i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function Xe(o,e,s){let t;P(o,R,l=>s(1,t=l));const n=l=>{const f=[];return l.forEach((c,p)=>{p%2!=0&&f.push([l[p-1],c])}),f};let a,{active:i}=e;const u=R.subscribe(l=>{if(!l.length||!i)return;const f=l.findIndex(_=>_.elapsed<_.duration&&_.type===h.WORK);if(f===-1)return;const c=Math.ceil(f/2)-1,p=a.children[c];a.scrollTo({top:p.offsetHeight*c,behavior:"smooth"})});Q(()=>u());function r(l){X[l?"unshift":"push"](()=>{a=l,s(0,a)})}return o.$$set=l=>{"active"in l&&s(3,i=l.active)},[a,t,n,i,r]}class Ye extends C{constructor(e){super();V(this,e,Xe,Qe,j,{active:3})}}function Ze(o){let e,s;return e=new Fe({}),{c(){S(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){E(e,t,n),s=!0},i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function Me(o){let e,s,t,n,a,i,u,r;function l(c){o[8](c)}let f={timeKeeper:o[3],value:o[1],$$slots:{default:[Ze]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.active=o[0]),e=new Oe({props:f}),X.push(()=>ee(e,"active",l)),n=new Ke({props:{buttons:o[6]()}}),n.$on("click",o[5]),u=new Ye({props:{active:o[0]}}),{c(){S(e.$$.fragment),t=O(),a=A("div"),S(n.$$.fragment),i=O(),S(u.$$.fragment),this.h()},l(c){T(e.$$.fragment,c),t=K(c),a=W(c,"DIV",{style:!0});var p=L(a);T(n.$$.fragment,p),i=K(c),T(u.$$.fragment,c),this.h()},h(){te(a,"display","contents"),te(a,"--theme-icon-size","1.6rem")},m(c,p){E(e,c,p),w(c,t,p),w(c,a,p),E(n,a,null),w(c,i,p),E(u,c,p),r=!0},p(c,[p]){const _={};p&2&&(_.value=c[1]),p&1048576&&(_.$$scope={dirty:p,ctx:c}),!s&&p&1&&(s=!0,_.active=c[0],ne(()=>s=!1)),e.$set(_);const v={};p&1&&(v.active=c[0]),u.$set(v)},i(c){r||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(u.$$.fragment,c),r=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(u.$$.fragment,c),r=!1},d(c){I(e,c),c&&$(t),c&&$(a),I(n,c),c&&$(i),I(u,c)}}}function xe(o,e,s){let t,n,a,i;P(o,R,m=>s(9,t=m));let{settingsOpen:u=!1}=e,r;const l=Y.userSettings;P(o,l,m=>s(11,a=m));const f=Y.docBodyBgColor,c=Ve();P(o,c,m=>s(10,n=m));const p=m=>Object.entries(h).reduce((y,b)=>b[1]===t[m].type?b[0]:y,null),_=()=>t.findIndex(m=>m.elapsed<m.duration),v=()=>{const m=t.findIndex(B=>B.type===h.WORK&&B.elapsed===0);if(m===-1)return"";const y=t[m];let b=`Next Exercise is ${y.display_name}
`;return y.band_pos>0&&(b+=`Band's Position: ${y.band_pos_text}`),b},k=Se(R,m=>{if(!m.length||!R.hasStarted())return 0;const y=_();if(y===-1)return 0;const b=m[y];return b.duration-b.elapsed});P(o,k,m=>s(1,i=m));const ce=m=>{if(!a.use_voice||!c.isTicking())return;const y=_();if(y===-1)return;let b="";const B=t[y];switch(B.elapsed){case 0:switch(B.type){case h.WORK:b+=`Go
`;break;case h.REST:case h.BREAK:b+=`Stop
`;break}break;case 1:switch(B.type){case h.REST:b+=`Rest
`;break;case h.BREAK:b+=`Break
`;break;case h.PREP:b+=`Prep
`;break}break;case 2:switch(B.type){case h.REST:case h.PREP:b+=v();break}break}if(m<4)b+=`${m}
`;else if(B.type===h.BREAK)switch(m){case 14:b+=v();break;case 15:b+=`Get Ready
`;break}else R.isComplete()&&(b+=`Well done
`);b.length&&Z.speak(b)},ue=m=>{const y=_();y==-1||n===0?f.set(null):(c.isTicking()&&!document.body.classList.length||m===t[y].duration)&&f.set(p(y))},fe=m=>{switch(c.isTicking()&&c.stop(),m.currentTarget.dataset.action){case"reset":s(0,r=!1),c.reset(),R.reset();break;case"settings_open":s(7,u=!0);break}},pe=()=>[{icon:"bi bi-bootstrap-reboot",title:"Reset",data:{"data-action":"reset"}},{component:Ce,props:{}},{icon:"bi bi-gear-wide-connected",title:"Timer Settings",data:{"data-action":"settings_open"}}],me=c.subscribe(()=>{const m=_();m!==-1&&c.isTicking()&&J(R,t[m].elapsed+=1,t)}),_e=k.subscribe(m=>{ce(m),ue(m)});Q(()=>{me(),_e(),f.set(null)});function de(m){r=m,s(0,r)}return o.$$set=m=>{"settingsOpen"in m&&s(7,u=m.settingsOpen)},[r,i,l,c,k,fe,pe,u,de]}class et extends C{constructor(e){super();V(this,e,xe,Me,j,{settingsOpen:7})}}function tt(o){let e,s,t;function n(i){o[4](i)}let a={};return o[0]!==void 0&&(a.settingsOpen=o[0]),e=new et({props:a}),X.push(()=>ee(e,"settingsOpen",n)),{c(){S(e.$$.fragment)},l(i){T(e.$$.fragment,i)},m(i,u){E(e,i,u),t=!0},p(i,u){const r={};!s&&u&1&&(s=!0,r.settingsOpen=i[0],ne(()=>s=!1)),e.$set(r)},i(i){t||(d(e.$$.fragment,i),t=!0)},o(i){g(e.$$.fragment,i),t=!1},d(i){I(e,i)}}}function nt(o){let e,s;return e=new Le({}),e.$on("click",o[2]),e.$on("submit",o[3]),{c(){S(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){E(e,t,n),s=!0},p:F,i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function st(o){let e,s,t,n,a;const i=[nt,tt],u=[];function r(l,f){return l[0]?0:l[1].length?1:-1}return~(s=r(o))&&(t=u[s]=i[s](o)),{c(){e=O(),t&&t.c(),n=G(),this.h()},l(l){Te('[data-svelte="svelte-1jsep15"]',document.head).forEach($),e=K(l),t&&t.l(l),n=G(),this.h()},h(){document.title="SWEAT Tabata"},m(l,f){w(l,e,f),~s&&u[s].m(l,f),w(l,n,f),a=!0},p(l,[f]){let c=s;s=r(l),s===c?~s&&u[s].p(l,f):(t&&(H(),g(u[c],1,1,()=>{u[c]=null}),q()),~s?(t=u[s],t?t.p(l,f):(t=u[s]=i[s](l),t.c()),d(t,1),t.m(n.parentNode,n)):t=null)},i(l){a||(d(t),a=!0)},o(l){g(t),a=!1},d(l){l&&$(e),~s&&u[s].d(l),l&&$(n)}}}function rt(o,e,s){let t;P(o,R,r=>s(1,t=r));let n;Ee(()=>{const r=se.getItem("routine");if(r.length)R.set(r);else{const l=we.getItem("workout");l&&R.setWorkout(l)}return t.length||Ie("/workout",{replaceState:!0}),()=>se.setItem("routine",t)});const a=()=>s(0,n=!n),i=()=>s(0,n=!n);function u(r){n=r,s(0,n)}return[n,t,a,i,u]}class mt extends C{constructor(e){super();V(this,e,rt,st,j,{})}}export{mt as default};
