import{C as ge,S as C,i as V,s as j,v as R,w as S,x as T,F,p as d,n as g,A as E,L as P,M as J,V as Y,e as A,j as O,c as W,a as L,l as K,d as $,b as D,f as w,E as N,J as Z,P as be,R as he,T as $e,U as ve,k as G,m as q,o as H,H as M,t as ke,g as ye,h as Re,N as x,O as ee,G as te,Q as ne,a0 as Se,$ as Te,u as Ee}from"../../chunks/vendor-7dd5008c.js";import{g as Ie}from"../../chunks/navigation-c71191e7.js";import{A as Q,S as se,L as we}from"../../chunks/appStore-a84150de.js";import{r as h,R as U,E as Be}from"../../chunks/exerciseCard-f0b5e9b3.js";import{V as X,s as re}from"../../chunks/Voice-81b0b1bb.js";import{F as Pe,L as z,M as Oe,I as Ke,P as Ce}from"../../chunks/playPauseToggleIcon-65a1b99b.js";import{T as Ve}from"../../chunks/TimeKeeper-f0532b37.js";import"../../chunks/singletons-a42a5e91.js";const je=()=>{const{subscribe:l,set:e,update:s}=ge([]),t=r=>{e(n(r.meta,r.exercises))},n=(r,i)=>{let f=[];for(let u=0;u<r.tabatas;u++)if(i.forEach((p,_)=>{const y=Object.assign({cycle:_+1,round:u+1,elapsed:0,duration:r.time_on},p);if(y.type=h.WORK,f.push(U(y)),_<i.length-1){const v={name:"Rest",display_name:"Rest",type:h.REST,cycle:_+1,round:u+1,elapsed:0,duration:r.time_off};f.push(U(v))}}),u<r.tabatas-1){const p={name:"Break",display_name:"Break",type:h.BREAK,cycle:0,round:u+2,elapsed:0,duration:r.rest_time};f.push(U(p))}return f.unshift(U({name:"Prepare",display_name:"Prep",type:h.PREP,cycle:0,round:0,elapsed:0,duration:r.prep_time})),f};return{subscribe:l,set:e,update:s,setWorkout:t,reset:()=>{s(r=>r.map(i=>(i.elapsed=0,i)))},isComplete:()=>{let r=!1;return s(i=>(r=Boolean(i.length)&&i.every(f=>f.elapsed===f.duration),i)),r},hasStarted:()=>{let r=!1;return l(f=>{f.length&&(r=f[0].elapsed>0)})(),r}}};var I=je();function Ae(l){let e,s;return e=new Pe({props:{id:"tabataSettingsForm",title:"Tabata Settings",fieldsets:l[1]()}}),e.$on("change",l[2]),e.$on("submit",l[3]),e.$on("click",l[4]),{c(){R(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,n){T(e,t,n),s=!0},p:F,i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){E(e,t)}}}function We(l,e,s){let t,n;P(l,I,f=>s(7,n=f));const a=Q.userSettings;P(l,a,f=>s(6,t=f));const o=()=>{const f=n.find(v=>v.type===h.PREP),u=n.find(v=>v.type===h.WORK),p=n.find(v=>v.type===h.REST),_=n.find(v=>v.type===h.BREAK);return[{legend:"Runtime",inputs:[{id:"prep_time",name:"PREP",value:f?f.duration:0,label:"Prep Time (seconds)",type:"number"},{id:"time_on",name:"WORK",value:u?u.duration:0,label:"Exercise Time (seconds)",type:"number"},{id:"time_off",name:"REST",value:p?p.duration:0,label:"Rest Time (seconds)",type:"number"},{id:"rest_time",name:"BREAK",value:_?_.duration:0,label:"Break Time (seconds)",type:"number"},{id:"use_voice",name:"use_voice",checked:t.use_voice,label:"Use Voice?",type:"slider"},{id:"preferred_voice",name:"preferred_voice",value:t.preferred_voice,label:"Preferred Voice",type:"select",placeholder:"Available Voices",options:X.getVoices(null,!0)}]}]},c=f=>{switch(f.currentTarget.name){case"PREP":case"WORK":case"REST":case"BREAK":const u=parseInt(f.currentTarget.value);isNaN(u)||I.update(p=>(p.forEach((_,y)=>{_.type===h[f.currentTarget.name]&&p[y].elapsed!==p[y].duration&&(p[y].duration=u)}),p));break;case"use_voice":J(a,t.use_voice=f.currentTarget.checked,t);break;case"preferred_voice":J(a,t.preferred_voice=f.currentTarget.value,t),X.defaultVoice=t.preferred_voice;break}};function r(f){Y.call(this,l,f)}function i(f){Y.call(this,l,f)}return[a,o,c,r,i]}class Le extends C{constructor(e){super();V(this,e,We,Ae,j,{})}}function De(l){let e,s,t,n,a,o,c,r,i;return s=new z({props:{label:"Elapsed",value:l[0]}}),n=new z({props:{label:"Remaining",value:l[1]}}),o=new z({props:{label:"Cycles",value:l[2]}}),r=new z({props:{label:"Tabatas",value:l[3]}}),{c(){e=A("div"),R(s.$$.fragment),t=O(),R(n.$$.fragment),a=O(),R(o.$$.fragment),c=O(),R(r.$$.fragment),this.h()},l(f){e=W(f,"DIV",{class:!0});var u=L(e);S(s.$$.fragment,u),t=K(u),S(n.$$.fragment,u),a=K(u),S(o.$$.fragment,u),c=K(u),S(r.$$.fragment,u),u.forEach($),this.h()},h(){D(e,"class","svelte-1ujgwto")},m(f,u){w(f,e,u),T(s,e,null),N(e,t),T(n,e,null),N(e,a),T(o,e,null),N(e,c),T(r,e,null),i=!0},p(f,[u]){const p={};u&1&&(p.value=f[0]),s.$set(p);const _={};u&2&&(_.value=f[1]),n.$set(_);const y={};u&4&&(y.value=f[2]),o.$set(y);const v={};u&8&&(v.value=f[3]),r.$set(v)},i(f){i||(d(s.$$.fragment,f),d(n.$$.fragment,f),d(o.$$.fragment,f),d(r.$$.fragment,f),i=!0)},o(f){g(s.$$.fragment,f),g(n.$$.fragment,f),g(o.$$.fragment,f),g(r.$$.fragment,f),i=!1},d(f){f&&$(e),E(s),E(n),E(o),E(r)}}}function Ne(l,e,s){let t="00:00",n="00:00",a="0/0",o="0/0";const c=I.subscribe(r=>{if(!r.length)return;const i=r.reduce((p,_)=>p+_.elapsed,0),f=r.reduce((p,_)=>p+_.duration,0),u=r.findIndex(p=>p.elapsed<p.duration);s(0,t=re(i)),s(1,n=re(f-i)),s(2,a=r[u].cycle+"/"+r[r.length-1].cycle),s(3,o=r[u].round+"/"+r[r.length-1].round)});return Z(()=>c()),[t,n,a,o]}class Fe extends C{constructor(e){super();V(this,e,Ne,De,j,{})}}function Ge(l){let e,s;const t=l[1].default,n=be(t,l,l[0],null);return{c(){e=A("div"),n&&n.c(),this.h()},l(a){e=W(a,"DIV",{class:!0});var o=L(e);n&&n.l(o),o.forEach($),this.h()},h(){D(e,"class","svelte-1vvydd2")},m(a,o){w(a,e,o),n&&n.m(e,null),s=!0},p(a,[o]){n&&n.p&&(!s||o&1)&&he(n,t,a,a[0],s?ve(t,a[0],o,null):$e(a[0]),null)},i(a){s||(d(n,a),s=!0)},o(a){g(n,a),s=!1},d(a){a&&$(e),n&&n.d(a)}}}function qe(l,e,s){let{$$slots:t={},$$scope:n}=e;return l.$$set=a=>{"$$scope"in a&&s(0,n=a.$$scope)},[n,t]}class He extends C{constructor(e){super();V(this,e,qe,Ge,j,{})}}function ae(l,e,s){const t=l.slice();return t[2]=e[s],t}function le(l,e,s){const t=l.slice();return t[5]=e[s],t}function Ue(l){let e,s=(l[5].display_name||l[5].name)+"",t;return{c(){e=A("h2"),t=ke(s),this.h()},l(n){e=W(n,"H2",{class:!0});var a=L(e);t=ye(a,s),a.forEach($),this.h()},h(){D(e,"class","rest-item svelte-1ne19n9")},m(n,a){w(n,e,a),N(e,t)},p(n,a){a&1&&s!==(s=(n[5].display_name||n[5].name)+"")&&Re(t,s)},i:F,o:F,d(n){n&&$(e)}}}function ze(l){let e,s;return e=new Be({props:{name:l[5].display_name||l[5].name,completed:l[5].duration===l[5].elapsed,region:l[5].region,target:l[5].target,band_pos:l[5].band_pos,band_pos_text:l[5].band_pos_text}}),{c(){R(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,n){T(e,t,n),s=!0},p(t,n){const a={};n&1&&(a.name=t[5].display_name||t[5].name),n&1&&(a.completed=t[5].duration===t[5].elapsed),n&1&&(a.region=t[5].region),n&1&&(a.target=t[5].target),n&1&&(a.band_pos=t[5].band_pos),n&1&&(a.band_pos_text=t[5].band_pos_text),e.$set(a)},i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){E(e,t)}}}function oe(l){let e,s,t,n;const a=[ze,Ue],o=[];function c(r,i){return r[5].type===h.WORK?0:1}return e=c(l),s=o[e]=a[e](l),{c(){s.c(),t=G()},l(r){s.l(r),t=G()},m(r,i){o[e].m(r,i),w(r,t,i),n=!0},p(r,i){let f=e;e=c(r),e===f?o[e].p(r,i):(q(),g(o[f],1,1,()=>{o[f]=null}),H(),s=o[e],s?s.p(r,i):(s=o[e]=a[e](r),s.c()),d(s,1),s.m(t.parentNode,t))},i(r){n||(d(s),n=!0)},o(r){g(s),n=!1},d(r){o[e].d(r),r&&$(t)}}}function ie(l){let e,s,t,n=l[2],a=[];for(let c=0;c<n.length;c+=1)a[c]=oe(le(l,n,c));const o=c=>g(a[c],1,1,()=>{a[c]=null});return{c(){e=A("li");for(let c=0;c<a.length;c+=1)a[c].c();s=O(),this.h()},l(c){e=W(c,"LI",{class:!0});var r=L(e);for(let i=0;i<a.length;i+=1)a[i].l(r);s=K(r),r.forEach($),this.h()},h(){D(e,"class","svelte-1ne19n9")},m(c,r){w(c,e,r);for(let i=0;i<a.length;i+=1)a[i].m(e,null);N(e,s),t=!0},p(c,r){if(r&3){n=c[2];let i;for(i=0;i<n.length;i+=1){const f=le(c,n,i);a[i]?(a[i].p(f,r),d(a[i],1)):(a[i]=oe(f),a[i].c(),d(a[i],1),a[i].m(e,s))}for(q(),i=n.length;i<a.length;i+=1)o(i);H()}},i(c){if(!t){for(let r=0;r<n.length;r+=1)d(a[r]);t=!0}},o(c){a=a.filter(Boolean);for(let r=0;r<a.length;r+=1)g(a[r]);t=!1},d(c){c&&$(e),M(a,c)}}}function Je(l){let e,s,t=l[1](l[0]),n=[];for(let o=0;o<t.length;o+=1)n[o]=ie(ae(l,t,o));const a=o=>g(n[o],1,1,()=>{n[o]=null});return{c(){e=A("ol");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=W(o,"OL",{class:!0});var c=L(e);for(let r=0;r<n.length;r+=1)n[r].l(c);c.forEach($),this.h()},h(){D(e,"class","svelte-1ne19n9")},m(o,c){w(o,e,c);for(let r=0;r<n.length;r+=1)n[r].m(e,null);s=!0},p(o,c){if(c&3){t=o[1](o[0]);let r;for(r=0;r<t.length;r+=1){const i=ae(o,t,r);n[r]?(n[r].p(i,c),d(n[r],1)):(n[r]=ie(i),n[r].c(),d(n[r],1),n[r].m(e,null))}for(q(),r=t.length;r<n.length;r+=1)a(r);H()}},i(o){if(!s){for(let c=0;c<t.length;c+=1)d(n[c]);s=!0}},o(o){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)g(n[c]);s=!1},d(o){o&&$(e),M(n,o)}}}function Qe(l){let e,s;return e=new He({props:{$$slots:{default:[Je]},$$scope:{ctx:l}}}),{c(){R(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,n){T(e,t,n),s=!0},p(t,[n]){const a={};n&257&&(a.$$scope={dirty:n,ctx:t}),e.$set(a)},i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){E(e,t)}}}function Xe(l,e,s){let t;return P(l,I,a=>s(0,t=a)),[t,a=>{const o=[];return a.forEach((c,r)=>{r%2!=0&&o.push([a[r-1],c])}),o}]}class Ye extends C{constructor(e){super();V(this,e,Xe,Qe,j,{})}}function Ze(l){let e,s;return e=new Fe({}),{c(){R(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,n){T(e,t,n),s=!0},i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){E(e,t)}}}function Me(l){let e,s,t,n,a,o,c,r;function i(u){l[8](u)}let f={timeKeeper:l[3],value:l[1],$$slots:{default:[Ze]},$$scope:{ctx:l}};return l[0]!==void 0&&(f.active=l[0]),e=new Oe({props:f}),x.push(()=>ee(e,"active",i)),n=new Ke({props:{buttons:l[6]()}}),n.$on("click",l[5]),c=new Ye({}),{c(){R(e.$$.fragment),t=O(),a=A("div"),R(n.$$.fragment),o=O(),R(c.$$.fragment),this.h()},l(u){S(e.$$.fragment,u),t=K(u),a=W(u,"DIV",{style:!0});var p=L(a);S(n.$$.fragment,p),o=K(u),S(c.$$.fragment,u),this.h()},h(){te(a,"display","contents"),te(a,"--theme-icon-size","1.6rem")},m(u,p){T(e,u,p),w(u,t,p),w(u,a,p),T(n,a,null),w(u,o,p),T(c,u,p),r=!0},p(u,[p]){const _={};p&2&&(_.value=u[1]),p&1048576&&(_.$$scope={dirty:p,ctx:u}),!s&&p&1&&(s=!0,_.active=u[0],ne(()=>s=!1)),e.$set(_)},i(u){r||(d(e.$$.fragment,u),d(n.$$.fragment,u),d(c.$$.fragment,u),r=!0)},o(u){g(e.$$.fragment,u),g(n.$$.fragment,u),g(c.$$.fragment,u),r=!1},d(u){E(e,u),u&&$(t),u&&$(a),E(n,u),u&&$(o),E(c,u)}}}function xe(l,e,s){let t,n,a,o;P(l,I,m=>s(9,t=m));let{settingsOpen:c=!1}=e,r;const i=Q.userSettings;P(l,i,m=>s(11,a=m));const f=Q.docBodyBgColor,u=Ve();P(l,u,m=>s(10,n=m));const p=m=>Object.entries(h).reduce((k,b)=>b[1]===t[m].type?b[0]:k,null),_=()=>t.findIndex(m=>m.elapsed<m.duration),y=()=>{const m=t.findIndex(B=>B.type===h.WORK&&B.elapsed===0);if(m===-1)return"";const k=t[m];let b=`Next Exercise is ${k.display_name}
`;return k.band_pos>0&&(b+=`Band's Position: ${k.band_pos_text}`),b},v=Se(I,m=>{if(!m.length||!I.hasStarted())return 0;const k=_();if(k===-1)return 0;const b=m[k];return b.duration-b.elapsed});P(l,v,m=>s(1,o=m));const ce=m=>{if(!a.use_voice||!u.isTicking())return;const k=_();if(k===-1)return;let b="";const B=t[k];switch(B.elapsed){case 0:switch(B.type){case h.WORK:b+=`Go
`;break;case h.REST:case h.BREAK:b+=`Stop
`;break}break;case 1:switch(B.type){case h.REST:b+=`Rest
`;break;case h.BREAK:b+=`Break
`;break;case h.PREP:b+=`Prep
`;break}break;case 2:switch(B.type){case h.REST:case h.PREP:b+=y();break}break}if(m<4)b+=`${m}
`;else if(B.type===h.BREAK)switch(m){case 14:b+=y();break;case 15:b+=`Get Ready
`;break}else I.isComplete()&&(b+=`Well done
`);b.length&&X.speak(b)},ue=m=>{const k=_();k==-1||n===0?f.set(null):(u.isTicking()&&!document.body.classList.length||m===t[k].duration)&&f.set(p(k))},fe=m=>{switch(u.isTicking()&&u.stop(),m.currentTarget.dataset.action){case"reset":s(0,r=!1),u.reset(),I.reset();break;case"settings_open":s(7,c=!0);break}},pe=()=>[{icon:"bi bi-bootstrap-reboot",title:"Reset",data:{"data-action":"reset"}},{component:Ce,props:{}},{icon:"bi bi-gear-wide-connected",title:"Timer Settings",data:{"data-action":"settings_open"}}],me=u.subscribe(()=>{const m=_();m!==-1&&u.isTicking()&&J(I,t[m].elapsed+=1,t)}),_e=v.subscribe(m=>{ce(m),ue(m)});Z(()=>{me(),_e(),f.set(null)});function de(m){r=m,s(0,r)}return l.$$set=m=>{"settingsOpen"in m&&s(7,c=m.settingsOpen)},[r,o,i,u,v,fe,pe,c,de]}class et extends C{constructor(e){super();V(this,e,xe,Me,j,{settingsOpen:7})}}function tt(l){let e,s,t;function n(o){l[4](o)}let a={};return l[0]!==void 0&&(a.settingsOpen=l[0]),e=new et({props:a}),x.push(()=>ee(e,"settingsOpen",n)),{c(){R(e.$$.fragment)},l(o){S(e.$$.fragment,o)},m(o,c){T(e,o,c),t=!0},p(o,c){const r={};!s&&c&1&&(s=!0,r.settingsOpen=o[0],ne(()=>s=!1)),e.$set(r)},i(o){t||(d(e.$$.fragment,o),t=!0)},o(o){g(e.$$.fragment,o),t=!1},d(o){E(e,o)}}}function nt(l){let e,s;return e=new Le({}),e.$on("click",l[2]),e.$on("submit",l[3]),{c(){R(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,n){T(e,t,n),s=!0},p:F,i(t){s||(d(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){E(e,t)}}}function st(l){let e,s,t,n,a;const o=[nt,tt],c=[];function r(i,f){return i[0]?0:i[1].length?1:-1}return~(s=r(l))&&(t=c[s]=o[s](l)),{c(){e=O(),t&&t.c(),n=G(),this.h()},l(i){Te('[data-svelte="svelte-1jsep15"]',document.head).forEach($),e=K(i),t&&t.l(i),n=G(),this.h()},h(){document.title="SWEAT Tabata"},m(i,f){w(i,e,f),~s&&c[s].m(i,f),w(i,n,f),a=!0},p(i,[f]){let u=s;s=r(i),s===u?~s&&c[s].p(i,f):(t&&(q(),g(c[u],1,1,()=>{c[u]=null}),H()),~s?(t=c[s],t?t.p(i,f):(t=c[s]=o[s](i),t.c()),d(t,1),t.m(n.parentNode,n)):t=null)},i(i){a||(d(t),a=!0)},o(i){g(t),a=!1},d(i){i&&$(e),~s&&c[s].d(i),i&&$(n)}}}function rt(l,e,s){let t;P(l,I,r=>s(1,t=r));let n;Ee(()=>{const r=se.getItem("routine");if(r.length)I.set(r);else{const i=we.getItem("workout");i&&I.setWorkout(i)}return t.length||Ie("/workout",{replaceState:!0}),()=>se.setItem("routine",t)});const a=()=>s(0,n=!n),o=()=>s(0,n=!n);function c(r){n=r,s(0,n)}return[n,t,a,o,c]}class mt extends C{constructor(e){super();V(this,e,rt,st,j,{})}}export{mt as default};
