import{D as oe,a3 as ie,ae as Ne,S as U,i as G,s as J,w as I,x as y,y as A,q as v,o as S,B as O,M as K,O as z,e as L,t as Y,k as N,c as R,a as D,h as Q,m as C,d as k,b as $,F as Z,g as T,G as X,J as ne,j as ce,H as se,I as fe,af as me,v as Ce,ag as Le,n as re,p as ae,_ as Re,Y as H,l as W,f as x,a2 as De,Q as pe,R as _e,U as be}from"../chunks/vendor-d368934e.js";import{g as qe}from"../chunks/navigation-bd39ff07.js";import{L as Xe,A as de,S as Be}from"../chunks/appStore-46e93785.js";import{V as ge}from"../chunks/ViewTitle-9db06c2e.js";import{t as he,g as Ke,p as Fe,s as ee}from"../chunks/helpers-4bb24296.js";import{a as w,b as ke,E as Ve}from"../chunks/exerciseCard-53d3faf9.js";import{F as We,I as Ee,M as ve,a as we,P as Me}from"../chunks/playPauseToggleIcon-3ad8ba20.js";import{p as ze}from"../chunks/stores-2ee95a45.js";import"../chunks/singletons-a6a7384f.js";const He=()=>{const{subscribe:s,set:e}=oe(null);return{subscribe:s,setDb:t=>{const c=new DOMParser().parseFromString(t,"text/xml"),f=c.querySelector("parsererror");e(f||c)}}};var M=He();const Ue=()=>({saveWorkout:e=>new Promise(n=>{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"};let r="https://kalabaaz.pythonanywhere.com";r+="/api/workout/save",fetch(r,t).then(async c=>{c.ok&&n()}).catch(c=>{console.error(c)})})});var Ge=Ue();const Se=ie(M,s=>{if(!s)return[];const e=s.querySelector("exercises");return Array.from(e.children).map(n=>Object.seal({id:n.tagName,title:he(n.tagName.replace("_"," "))}))},[]),le=(s=null)=>{const e=Object.preventExtensions({id:null,title:null,tabatas:3,prep_time:10,time_on:40,time_off:15,rest_time:60,with_equipment:!0,has_plank:!0,pathname:null,rules:{}}),{subscribe:n,set:t,update:r}=oe(e),c=i=>{i=Object.assign(e,i),Se.subscribe(m=>{if(m.length){const _=Object.fromEntries(m.map(p=>[p.id,0]));i.rules=Object.preventExtensions(Object.assign(_,i.rules))}return!0})(),t(i)},f=(i,o)=>{let m=!1;return r(_=>(o&&!isNaN(o)&&(_.rules[i]=o),m=!0,_)),m},u=(i=null)=>(i||n(m=>i=m)(),Object.entries(i.rules).reduce((o,m)=>o+(isNaN(m[1])?0:m[1]),0)),a=(i=null)=>{i||n(p=>i=p)();const o=u(i);let m=0;return m+=i.prep_time,m+=i.time_on*o*i.tabatas,m+=i.time_off*(o-1)*i.tabatas,m+=i.rest_time*(i.tabatas-1),m},l=(i=null)=>{let o;return n(_=>o=_)(),i?o[i]:o},b=(i=null)=>{i||n(_=>i=_)();const o=Object.fromEntries(Object.entries(i));return o.rules=Object.fromEntries(Object.entries(i.rules)),o};return s&&c(s),{subscribe:n,set:c,get:l,clone:b,update:r,updateRule:f,getTotalTime:a,getTotalExercises:u}},Je=ie(M,(s,e)=>{if(!s)return[];const n=s.querySelector("selection_rules");if(!n)return[];const t=[];Array.from(n.children).forEach(r=>{const c={id:r.tagName,title:he(r.tagName.replace("_"," ")),tabatas:parseInt(r.getAttribute("tabatas")),rest_time:parseInt(r.getAttribute("rest_time")),time_on:parseInt(r.getAttribute("time_on")),time_off:parseInt(r.getAttribute("time_off")),prep_time:parseInt(r.getAttribute("prep_time"))||10},f=Array.from(r.children).map(u=>[u.tagName,parseInt(u.getAttribute("select"))]);c.rules=Object.fromEntries(f),t.push(le(c))}),e(t)},[]),Ye=(s=le())=>{const e=Object.preventExtensions({meta:s?s.get():null,[w.EXERCISE]:[],[w.PLANK]:[]}),{subscribe:n,set:t,update:r}=oe(e),c=(p=le())=>{s=p,M.subscribe(h=>{if(!h)return;const d={};d.meta=a(s.get()),d[w.EXERCISE]=[],d[w.PLANK]=[];for(let E in d.meta.rules){if(!parseInt(d.meta.rules[E]))continue;const P=h.querySelector("exercises > "+E).children;d[w.EXERCISE]=d[w.EXERCISE].concat(o(P,d.meta.rules[E],!1,d.meta.with_equipment))}if(d.meta.with_equipment){const E=Math.random()>.5?1:-1;d[w.EXERCISE]=d[w.EXERCISE].sort((P,V)=>(P.band_pos-V.band_pos)*E)}if(d.meta.has_plank){const E=h.querySelector("planks");d[w.PLANK]=o(E.children,parseInt(E.getAttribute("select")),!0,d.meta.with_equipment)}t(d)})()},f=(p=!1)=>{r(g=>(p===!0&&(g.meta.pathname||(g.meta.pathname=Ke(10)),Ge.saveWorkout(g)),Xe.setItem("workout",g),g))},u=(p=null)=>{p||n(E=>p=E)();const g=p[w.EXERCISE].length;let h=0;return h+=p.meta.prep_time,h+=p.meta.time_on*g*p.meta.tabatas,h+=p.meta.time_off*(g-1)*p.meta.tabatas,h+=p.meta.rest_time*(p.meta.tabatas-1),h},a=(p=null)=>{p||n(d=>p=d.meta)()();const g=Object.fromEntries(Object.entries(p));return g.rules=Object.fromEntries(Object.entries(p.rules)),g},l=(p=-1,g=w.EXERCISE,h="replace")=>{r(d=>{const E=d[g][p];switch(h){case"delete":m(p,d[g]),g!==w.PLANK&&(d.meta.rules[E.region]-=1);break;case"replace":const P=i(p,d[g],g);P.length&&m(p,d[g],P);break}return d})},b=(p=-1,g=-1,h=w.EXERCISE)=>{p<0||r(d=>{const E=d[h].length;g==-1?g=E-1:g==E&&(g=0);const P=d[h].splice(g,1,d[h][p]);return d[h].splice(p,1,...P),d})},i=(p,g,h)=>{const d=g[p];if(!d)return[];const E=g.filter(F=>F.region===d.region).map(F=>F.name),P=Ne(M);let V=h;h==w.EXERCISE&&(V+=" > "+d.region);let q=P.querySelector(V);const te=Array.from(q.children).filter(F=>!E.includes(F.getAttribute("name")));return o(te,1,h==w.PLANK)},o=(p,g,h,d=!0)=>{p=p instanceof Array?p:Array.from(p),d===!1&&(p=p.filter(q=>parseInt(q.getAttribute("band_pos"))==0)),p.length>g&&(p=Fe(p,g));let E;_.subscribe(q=>E=q)();let V=[];for(let q in p){const te=Boolean(parseInt(p[q].getAttribute("has_lr"))),F=p[q].getAttribute("name"),B=ke();if(B.type=h?w.PLANK:w.EXERCISE,B.name=F,B.display_name=F+(te?" (Right)":""),B.region=p[q].parentElement.tagName,B.target=p[q].getAttribute("target"),B.has_lr=te,B.band_pos=parseInt(p[q].getAttribute("band_pos")),B.band_pos_text=E[p[q].getAttribute("band_pos")],te){const ue=Object.assign(ke(),B);ue.display_name=F+" (Left)",V.push(ue)}V.push(B)}return V},m=(p=-1,g=[],h=[])=>{const d=g[p],E=d.has_lr===!0?g.findIndex(P=>P.name==d.name&&P!==d):-1;E>-1&&(g.splice(E,1),p=g.indexOf(d)),h.length?g.splice(p,1,...h):g.splice(p,1)},_=ie(M,p=>{if(!p)return{};const g={},h=p.querySelector("band_legends");return Array.from(h.children).forEach(d=>{g[d.getAttribute("id")]=d.getAttribute("title")}),g},{});return{subscribe:n,set:t,update:r,save:f,cloneMeta:a,alterExercise:l,swapExercise:b,getTotalTime:u,get preset(){return s},set preset(p){c(p)}}};var j=Ye();function Qe(s){let e,n;return e=new We({props:{id:Ze,title:"Customize "+s[0].title+" Workout",fieldsets:s[3]()}}),e.$on("change",s[1]),e.$on("click",s[2]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,[r]){const c={};r&1&&(c.title="Customize "+t[0].title+" Workout"),e.$set(c)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}const Ze="workoutSettingsForm";function xe(s,e,n){let t,r,c;K(s,j,_=>n(6,t=_)),K(s,Se,_=>n(7,c=_));const f=(_,p)=>{const g=_.currentTarget.type==="checkbox"?_.currentTarget.checked:parseInt(_.currentTarget.value);if(!isNaN(g)){if(p){o.updateRule(_.currentTarget.name,g);const d=_.currentTarget.form.querySelector("input[name=total_exercises]");d.value=o.getTotalExercises(r)}else z(o,r[_.currentTarget.name]=g,r);const h=_.currentTarget.form.querySelector("input[name=total_time]");h.value=ee(o.getTotalTime(r))}},u=_=>{const p=_.currentTarget,g=Object.keys(i).includes(p.name),h=["has_plank","with_equipment"].includes(p.name);f(_,!g&&!h)},a=_=>{_.preventDefault();const p=new FormData(_.currentTarget.form);z(o,r.tabatas=parseInt(p.get("tabatas")),r),z(o,r.prep_time=parseInt(p.get("prep_time")),r),z(o,r.time_on=parseInt(p.get("time_on")),r),z(o,r.time_off=parseInt(p.get("time_off")),r),z(o,r.rest_time=parseInt(p.get("rest_time")),r);for(let g in r.rules)z(o,r.rules[g]=parseInt(p.get(g)),r);j.preset=o},l=_=>{_.currentTarget.name==="submit"&&a(_),n(5,m=!1)},b=()=>{const _=[];let p={legend:"Exercises",inputs:[]};return c.forEach(g=>{const h={label:g.title,type:"number",value:r.rules[g.id],id:g.id,name:g.id};p.inputs.push(h)}),p.inputs.push({label:"Total Exercises",type:"text",value:o.getTotalExercises(r),id:"total_exercises",name:"total_exercises",readonly:!0}),_.push(p),p={legend:"Time:",inputs:[]},Object.entries(i).forEach(g=>{const h={label:g[1],type:"number",value:r[g[0]],id:g[0],name:g[0]};p.inputs.push(h)}),p.inputs.push({label:"Total Time",type:"text",value:ee(o.getTotalTime(r)),id:"total_time",name:"total_time",readonly:!0}),_.push(p),p={legend:"Options:",inputs:[]},p.inputs.push({label:"Planks?",type:"slider",checked:r.has_plank,id:"has_plank",name:"has_plank"}),p.inputs.push({label:"Use Bands?",type:"slider",checked:r.with_equipment,id:"with_equipment",name:"with_equipment"}),_.push(p),p={inputs:[{label:"Generate",bindValue:!1,type:"submit",value:"Generate Workout",id:"submit",name:"submit"}]},_.push(p),_},i={prep_time:"Prep Time (seconds)",time_on:"Active Time (seconds)",time_off:"Rest Time (seconds)",rest_time:"Break Time (seconds)",tabatas:"Rounds"},o=le(t.meta);K(s,o,_=>n(0,r=_));let{open:m=!0}=e;return s.$$set=_=>{"open"in _&&n(5,m=_.open)},[r,u,l,b,o,m]}class et extends U{constructor(e){super();G(this,e,xe,Qe,J,{open:5})}}function Te(s,e,n){const t=s.slice();return t[10]=e[n],t}function $e(s){let e,n=s[10][1]+"",t,r,c,f,u,a;return{c(){e=L("span"),t=Y(n),r=N(),this.h()},l(l){e=R(l,"SPAN",{class:!0,"data-value":!0,"data-placeholder":!0});var b=D(e);t=Q(b,n),r=C(b),b.forEach(k),this.h()},h(){$(e,"class","sel-box-option svelte-6j4pg4"),$(e,"data-value",c=s[10][0]),$(e,"data-placeholder",f=s[10][1]),Z(e,"selected",s[0]===s[10][0])},m(l,b){T(l,e,b),X(e,t),X(e,r),u||(a=ne(e,"click",s[5]),u=!0)},p(l,b){b&8&&n!==(n=l[10][1]+"")&&ce(t,n),b&8&&c!==(c=l[10][0])&&$(e,"data-value",c),b&8&&f!==(f=l[10][1])&&$(e,"data-placeholder",f),b&9&&Z(e,"selected",l[0]===l[10][0])},d(l){l&&k(e),u=!1,a()}}}function tt(s){let e,n,t,r,c,f,u,a=s[3],l=[];for(let b=0;b<a.length;b+=1)l[b]=$e(Te(s,a,b));return{c(){e=L("div"),n=L("span"),t=Y(s[1]),r=N(),c=L("div");for(let b=0;b<l.length;b+=1)l[b].c();this.h()},l(b){e=R(b,"DIV",{class:!0,id:!0});var i=D(e);n=R(i,"SPAN",{class:!0,"data-label":!0});var o=D(n);t=Q(o,s[1]),o.forEach(k),r=C(i),c=R(i,"DIV",{class:!0});var m=D(c);for(let _=0;_<l.length;_+=1)l[_].l(m);m.forEach(k),i.forEach(k),this.h()},h(){$(n,"class","sel-placeholder svelte-6j4pg4"),$(n,"data-label",s[1]),$(c,"class","sel-box svelte-6j4pg4"),$(e,"class","sel svelte-6j4pg4"),$(e,"id",s[2]),Z(e,"active",s[4])},m(b,i){T(b,e,i),X(e,n),X(n,t),X(e,r),X(e,c);for(let o=0;o<l.length;o+=1)l[o].m(c,null);f||(u=ne(e,"click",s[6]),f=!0)},p(b,[i]){if(i&2&&ce(t,b[1]),i&2&&$(n,"data-label",b[1]),i&41){a=b[3];let o;for(o=0;o<a.length;o+=1){const m=Te(b,a,o);l[o]?l[o].p(m,i):(l[o]=$e(m),l[o].c(),l[o].m(c,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=a.length}i&4&&$(e,"id",b[2]),i&16&&Z(e,"active",b[4])},i:se,o:se,d(b){b&&k(e),fe(l,b),f=!1,u()}}}function nt(s,e,n){const t=me(),r=()=>{const m=document.getElementById(b);if(!m)return null;let _="";return m.querySelectorAll(".sel-box-option").forEach(p=>{p.dataset.value==i&&(_=p.dataset.label)}),_},c=m=>{const _=document.getElementById(b).querySelector(".sel-placeholder");_.textContent=m},f=m=>{m.currentTarget.dataset.value!=i&&(n(0,i=m.currentTarget.dataset.value),c(m.currentTarget.dataset.placeholder),t("change",i))},u=()=>{n(4,a=!a),t("open",a)};Ce(()=>{const m=r();m&&c(m)});let a=!1,{label:l,name:b,value:i,options:o}=e;return s.$$set=m=>{"label"in m&&n(1,l=m.label),"name"in m&&n(2,b=m.name),"value"in m&&n(0,i=m.value),"options"in m&&n(3,o=m.options)},[i,l,b,o,a,f,u]}class st extends U{constructor(e){super();G(this,e,nt,tt,J,{label:1,name:2,value:0,options:3})}}function Ie(s,e,n){const t=s.slice();return t[11]=e[n],t[13]=n,t}function rt(s){let e,n;return e=new Ee({props:{buttons:typeof s[2]=="function"?s[2](s[1],s[13]):s[2]}}),e.$on("click",s[7]),e.$on("dblclick",s[8]),e.$on("mouseenter",s[9]),e.$on("mouseleave",s[10]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&6&&(c.buttons=typeof t[2]=="function"?t[2](t[1],t[13]):t[2]),e.$set(c)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ye(s){let e,n,t,r,c,f;return n=new Ve({props:{name:s[11].display_name,completed:!1,region:s[11].region,target:s[11].target,band_pos:s[11].band_pos,band_pos_text:s[11].band_pos_text,$$slots:{default:[rt]},$$scope:{ctx:s}}}),{c(){e=L("li"),I(n.$$.fragment),t=N(),this.h()},l(u){e=R(u,"LI",{draggable:!0,class:!0});var a=D(e);y(n.$$.fragment,a),t=C(a),a.forEach(k),this.h()},h(){$(e,"draggable",s[3]),$(e,"class","svelte-1i892xx"),Z(e,"grabbable",s[3])},m(u,a){T(u,e,a),A(n,e,null),X(e,t),r=!0,c||(f=ne(e,"dragstart",s[6]),c=!0)},p(u,a){const l={};a&2&&(l.name=u[11].display_name),a&2&&(l.region=u[11].region),a&2&&(l.target=u[11].target),a&2&&(l.band_pos=u[11].band_pos),a&2&&(l.band_pos_text=u[11].band_pos_text),a&16390&&(l.$$scope={dirty:a,ctx:u}),n.$set(l),(!r||a&8)&&$(e,"draggable",u[3]),a&8&&Z(e,"grabbable",u[3])},i(u){r||(v(n.$$.fragment,u),r=!0)},o(u){S(n.$$.fragment,u),r=!1},d(u){u&&k(e),O(n),c=!1,f()}}}function at(s){let e,n,t,r,c,f,u,a=s[1],l=[];for(let i=0;i<a.length;i+=1)l[i]=ye(Ie(s,a,i));const b=i=>S(l[i],1,1,()=>{l[i]=null});return{c(){e=L("h5"),n=Y(s[0]),t=N(),r=L("ol");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=R(i,"H5",{class:!0});var o=D(e);n=Q(o,s[0]),o.forEach(k),t=C(i),r=R(i,"OL",{class:!0});var m=D(r);for(let _=0;_<l.length;_+=1)l[_].l(m);m.forEach(k),this.h()},h(){$(e,"class","svelte-1i892xx"),$(r,"class","svelte-1i892xx")},m(i,o){T(i,e,o),X(e,n),T(i,t,o),T(i,r,o);for(let m=0;m<l.length;m+=1)l[m].m(r,null);c=!0,f||(u=[ne(r,"dragover",Le(s[4])),ne(r,"drop",s[5])],f=!0)},p(i,[o]){if((!c||o&1)&&ce(n,i[0]),o&14){a=i[1];let m;for(m=0;m<a.length;m+=1){const _=Ie(i,a,m);l[m]?(l[m].p(_,o),v(l[m],1)):(l[m]=ye(_),l[m].c(),v(l[m],1),l[m].m(r,null))}for(re(),m=a.length;m<l.length;m+=1)b(m);ae()}},i(i){if(!c){for(let o=0;o<a.length;o+=1)v(l[o]);c=!0}},o(i){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)S(l[o]);c=!1},d(i){i&&k(e),i&&k(t),i&&k(r),fe(l,i),f=!1,Re(u)}}}function lt(s,e,n){let{title:t,items:r,buttons:c}=e,{draggable:f=!0}=e;function u(_){H.call(this,s,_)}function a(_){H.call(this,s,_)}function l(_){H.call(this,s,_)}function b(_){H.call(this,s,_)}function i(_){H.call(this,s,_)}function o(_){H.call(this,s,_)}function m(_){H.call(this,s,_)}return s.$$set=_=>{"title"in _&&n(0,t=_.title),"items"in _&&n(1,r=_.items),"buttons"in _&&n(2,c=_.buttons),"draggable"in _&&n(3,f=_.draggable)},[t,r,c,f,u,a,l,b,i,o,m]}class Ae extends U{constructor(e){super();G(this,e,lt,at,J,{title:0,items:1,buttons:2,draggable:3})}}function Oe(s){let e,n;return e=new Ae({props:{title:"Planks",items:s[0][w.PLANK],draggable:s[2]>1,buttons:s[6]}}),e.$on("dragstart",s[3]),e.$on("drop",s[4]),e.$on("click",s[5]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&1&&(c.items=t[0][w.PLANK]),e.$set(c)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ot(s){let e,n,t,r;e=new Ae({props:{title:"Exercises",items:s[0][w.EXERCISE],draggable:s[1]>1,buttons:s[6]}}),e.$on("dragstart",s[3]),e.$on("drop",s[4]),e.$on("click",s[5]);let c=s[0][w.PLANK].length>0&&s[0].meta.has_plank===!0&&Oe(s);return{c(){I(e.$$.fragment),n=N(),c&&c.c(),t=W()},l(f){y(e.$$.fragment,f),n=C(f),c&&c.l(f),t=W()},m(f,u){A(e,f,u),T(f,n,u),c&&c.m(f,u),T(f,t,u),r=!0},p(f,[u]){const a={};u&1&&(a.items=f[0][w.EXERCISE]),e.$set(a),f[0][w.PLANK].length>0&&f[0].meta.has_plank===!0?c?(c.p(f,u),u&1&&v(c,1)):(c=Oe(f),c.c(),v(c,1),c.m(t.parentNode,t)):c&&(re(),S(c,1,1,()=>{c=null}),ae())},i(f){r||(v(e.$$.fragment,f),v(c),r=!0)},o(f){S(e.$$.fragment,f),S(c),r=!1},d(f){O(e,f),f&&k(n),c&&c.d(f),f&&k(t)}}}function it(s,e,n){let t;K(s,j,i=>n(0,t=i));let r=t[w.EXERCISE].length,c=t[w.PLANK].length,f=null;return[t,r,c,i=>{f=i.currentTarget,i.dataTransfer.effectAllowed="move"},i=>{i.preventDefault();const o=i.path.indexOf(f.parentNode);if(o<1)return;const m=i.path[o-1];if(f===m)return;const _=Array.from(f.parentNode.children);j.swapExercise(_.indexOf(f),_.indexOf(m),w.EXERCISE)},i=>{const o=i.currentTarget.dataset,m=parseInt(o.id);switch(o.action){case"up":case"down":j.swapExercise(m,m+(o.action=="down"?1:-1),o.type);break;case"delete":case"replace":j.alterExercise(m,o.type,o.action);break}},(i,o)=>{const m=i.type===w.PLANK?c>1:r>1,_=i.type===w.PLANK?!1:r>1,p={"data-id":o,"data-type":i.type};return[{icon:"bi bi-arrow-repeat",title:"Replace Exercise",disabled:!1,data:Object.assign({"data-action":"replace"},p)},{icon:"bi bi-arrow-up-circle",title:"Move Up",disabled:!m,data:Object.assign({"data-action":"up"},p)},{icon:"bi bi-arrow-down-circle",title:"Move Down",disabled:!m,data:Object.assign({"data-action":"down"},p)},{icon:"bi bi-trash",title:"Trash",disabled:!_,data:Object.assign({"data-action":"delete"},p)}]}]}class ct extends U{constructor(e){super();G(this,e,it,ot,J,{})}}function je(s){let e,n,t,r,c,f,u,a,l,b,i;return e=new ve({props:{click:s[5],$$slots:{default:[ut]},$$scope:{ctx:s}}}),r=new Ee({props:{buttons:s[6]()}}),r.$on("click",s[4]),u=new ct({}),l=new ve({props:{click:s[5],$$slots:{default:[ft]},$$scope:{ctx:s}}}),{c(){n=L("div"),I(e.$$.fragment),t=N(),c=L("div"),I(r.$$.fragment),f=N(),I(u.$$.fragment),a=N(),b=L("div"),I(l.$$.fragment),this.h()},l(o){n=R(o,"DIV",{style:!0});var m=D(n);y(e.$$.fragment,m),t=C(o),c=R(o,"DIV",{style:!0});var _=D(c);y(r.$$.fragment,_),f=C(o),y(u.$$.fragment,o),a=C(o),b=R(o,"DIV",{style:!0});var p=D(b);y(l.$$.fragment,p),this.h()},h(){x(n,"display","contents"),x(n,"--theme-icon-size",".4rem"),x(c,"display","contents"),x(c,"--theme-icon-size","1.6rem"),x(b,"display","contents"),x(b,"--theme-icon-size",".3rem")},m(o,m){T(o,n,m),A(e,n,null),T(o,t,m),T(o,c,m),A(r,c,null),T(o,f,m),A(u,o,m),T(o,a,m),T(o,b,m),A(l,b,null),i=!0},p(o,m){const _={};m&32770&&(_.$$scope={dirty:m,ctx:o}),e.$set(_);const p={};m&32770&&(p.$$scope={dirty:m,ctx:o}),l.$set(p)},i(o){i||(v(e.$$.fragment,o),v(r.$$.fragment,o),v(u.$$.fragment,o),v(l.$$.fragment,o),i=!0)},o(o){S(e.$$.fragment,o),S(r.$$.fragment,o),S(u.$$.fragment,o),S(l.$$.fragment,o),i=!1},d(o){o&&k(n),O(e,o),o&&k(t),o&&k(c),O(r,o),o&&k(f),O(u,o),o&&k(a),o&&k(b),O(l,o)}}}function ut(s){let e,n;return e=new we({props:{label:"Total Time",value:ee(j.getTotalTime(s[1]))}}),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&2&&(c.value=ee(j.getTotalTime(t[1]))),e.$set(c)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ft(s){let e,n;return e=new we({props:{label:"Total Time",value:ee(j.getTotalTime(s[1]))}}),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&2&&(c.value=ee(j.getTotalTime(t[1]))),e.$set(c)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function mt(s){let e,n,t,r,c,f;e=new ge({props:{title:""+((s[1].meta.title?s[1].meta.title:"Create")+" Workout")}}),t=new st({props:{label:"Presets",name:"preset",value:s[1].meta.id,options:s[2].map(Pe)}}),t.$on("change",s[8]),t.$on("open",s[9]);let u=!s[0]&&s[1].exercises.length&&je(s);return{c(){I(e.$$.fragment),n=N(),I(t.$$.fragment),r=N(),u&&u.c(),c=W()},l(a){y(e.$$.fragment,a),n=C(a),y(t.$$.fragment,a),r=C(a),u&&u.l(a),c=W()},m(a,l){A(e,a,l),T(a,n,l),A(t,a,l),T(a,r,l),u&&u.m(a,l),T(a,c,l),f=!0},p(a,[l]){const b={};l&2&&(b.title=""+((a[1].meta.title?a[1].meta.title:"Create")+" Workout")),e.$set(b);const i={};l&2&&(i.value=a[1].meta.id),l&4&&(i.options=a[2].map(Pe)),t.$set(i),!a[0]&&a[1].exercises.length?u?(u.p(a,l),l&3&&v(u,1)):(u=je(a),u.c(),v(u,1),u.m(c.parentNode,c)):u&&(re(),S(u,1,1,()=>{u=null}),ae())},i(a){f||(v(e.$$.fragment,a),v(t.$$.fragment,a),v(u),f=!0)},o(a){S(e.$$.fragment,a),S(t.$$.fragment,a),S(u),f=!1},d(a){O(e,a),a&&k(n),O(t,a),a&&k(r),u&&u.d(a),a&&k(c)}}}const Pe=s=>[s.get("id"),s.get("title")];function pt(s,e,n){let t,r,c,f;K(s,j,d=>n(1,t=d)),K(s,ze,d=>n(11,c=d)),K(s,Je,d=>n(2,f=d));let u,{settingsOpen:a}=e;const l=me(),b=de.routine;K(s,b,d=>n(10,r=d));const i=d=>{switch(d.currentTarget.dataset.action){case"reset":j.preset=j.preset;break;case"share":m();break;case"settings_open":n(7,a=!0);break}},o=()=>"share"in navigator&&navigator.canShare(),m=async()=>{j.save(!0);const d={title:`Sweat ${t.meta.title} Workout`,text:"Here's the link to your saved workout.",url:`${c.url.origin}${r.tabataLink}/?w=${t.meta.pathname}&`};o()?window.navigator.share(d).catch(E=>{console.error(E)}):"clipboard"in navigator&&navigator.clipboard.writeText(d.url).then(()=>{console.info("Show copied notification here")}).catch(E=>{console.error(E)})},_=()=>{j.save(!1),l("workout")},p=()=>[{icon:"bi bi-bootstrap-reboot",title:"Reset",data:{"data-action":"reset"}},{component:Me,props:{}},{icon:`bi bi-${o()?"share-fill":"link"}`,title:"Share",data:{"data-action":"share"}},{icon:"bi bi-gear-wide-connected",title:"Timer Settings",data:{"data-action":"settings_open"}}],g=d=>j.preset=f.find(E=>E.get("id")==d.detail),h=d=>n(0,u=d.detail);return s.$$set=d=>{"settingsOpen"in d&&n(7,a=d.settingsOpen)},[u,t,f,b,i,_,p,a,g,h]}class _t extends U{constructor(e){super();G(this,e,pt,mt,J,{settingsOpen:7})}}function bt(s){let e,n,t,r,c,f,u,a;return{c(){e=L("h2"),n=Y("Unable to connect to database"),t=N(),r=L("p"),c=Y("This is embarrassing! I'm unable to connect to the database."),f=N(),u=L("p"),a=Y("Please try again later. Sorry!"),this.h()},l(l){e=R(l,"H2",{class:!0});var b=D(e);n=Q(b,"Unable to connect to database"),b.forEach(k),t=C(l),r=R(l,"P",{});var i=D(r);c=Q(i,"This is embarrassing! I'm unable to connect to the database."),i.forEach(k),f=C(l),u=R(l,"P",{});var o=D(u);a=Q(o,"Please try again later. Sorry!"),o.forEach(k),this.h()},h(){$(e,"class","center error")},m(l,b){T(l,e,b),X(e,n),T(l,t,b),T(l,r,b),X(r,c),T(l,f,b),T(l,u,b),X(u,a)},p:se,i:se,o:se,d(l){l&&k(e),l&&k(t),l&&k(r),l&&k(f),l&&k(u)}}}function dt(s){let e,n,t,r;const c=[ht,gt],f=[];function u(a,l){return a[0]?0:1}return e=u(s),n=f[e]=c[e](s),{c(){n.c(),t=W()},l(a){n.l(a),t=W()},m(a,l){f[e].m(a,l),T(a,t,l),r=!0},p(a,l){let b=e;e=u(a),e===b?f[e].p(a,l):(re(),S(f[b],1,1,()=>{f[b]=null}),ae(),n=f[e],n?n.p(a,l):(n=f[e]=c[e](a),n.c()),v(n,1),n.m(t.parentNode,t))},i(a){r||(v(n),r=!0)},o(a){S(n),r=!1},d(a){f[e].d(a),a&&k(t)}}}function gt(s){let e,n,t;function r(f){s[6](f)}let c={};return s[0]!==void 0&&(c.settingsOpen=s[0]),e=new _t({props:c}),pe.push(()=>_e(e,"settingsOpen",r)),e.$on("workout",s[3]),{c(){I(e.$$.fragment)},l(f){y(e.$$.fragment,f)},m(f,u){A(e,f,u),t=!0},p(f,u){const a={};!n&&u&1&&(n=!0,a.settingsOpen=f[0],be(()=>n=!1)),e.$set(a)},i(f){t||(v(e.$$.fragment,f),t=!0)},o(f){S(e.$$.fragment,f),t=!1},d(f){O(e,f)}}}function ht(s){let e,n,t,r,c;e=new ge({props:{title:"Customize Workout"}});function f(a){s[5](a)}let u={};return s[0]!==void 0&&(u.open=s[0]),t=new et({props:u}),pe.push(()=>_e(t,"open",f)),{c(){I(e.$$.fragment),n=N(),I(t.$$.fragment)},l(a){y(e.$$.fragment,a),n=C(a),y(t.$$.fragment,a)},m(a,l){A(e,a,l),T(a,n,l),A(t,a,l),c=!0},p(a,l){const b={};!r&&l&1&&(r=!0,b.open=a[0],be(()=>r=!1)),t.$set(b)},i(a){c||(v(e.$$.fragment,a),v(t.$$.fragment,a),c=!0)},o(a){S(e.$$.fragment,a),S(t.$$.fragment,a),c=!1},d(a){O(e,a),a&&k(n),O(t,a)}}}function kt(s){let e,n,t,r,c;const f=[dt,bt],u=[];function a(l,b){return l[1]?0:1}return n=a(s),t=u[n]=f[n](s),{c(){e=N(),t.c(),r=W(),this.h()},l(l){De('[data-svelte="svelte-8h4qcl"]',document.head).forEach(k),e=C(l),t.l(l),r=W(),this.h()},h(){document.title="SWEAT Workout"},m(l,b){T(l,e,b),u[n].m(l,b),T(l,r,b),c=!0},p(l,[b]){let i=n;n=a(l),n===i?u[n].p(l,b):(re(),S(u[i],1,1,()=>{u[i]=null}),ae(),t=u[n],t?t.p(l,b):(t=u[n]=f[n](l),t.c()),v(t,1),t.m(r.parentNode,r))},i(l){c||(v(t),c=!0)},o(l){S(t),c=!1},d(l){l&&k(e),u[n].d(l),l&&k(r)}}}async function jt({fetch:s}){const e={xml:null};let n=!1;if(M.subscribe(r=>{n=r!==null})(),!n){const r=await s("/data/workout_list.xml");r.ok&&(e.xml=await r.text())}return{props:e}}function Et(s,e,n){let t,r;K(s,M,i=>n(1,r=i));let{xml:c}=e;const f=de.routine;K(s,f,i=>n(7,t=i));const u=()=>{Be.setItem("routine",[]),qe(t.tabataLink)};c&&M.setDb(c);let a=!1;function l(i){a=i,n(0,a)}function b(i){a=i,n(0,a)}return s.$$set=i=>{"xml"in i&&n(4,c=i.xml)},[a,r,f,u,c,l,b]}class Pt extends U{constructor(e){super();G(this,e,Et,kt,J,{xml:4})}}export{Pt as default,jt as load};
