import{D as oe,a3 as ie,ae as Pe,S as G,i as H,s as J,w as I,x as y,y as A,q as E,o as w,B as O,M as V,P as z,e as L,t as Y,k as N,c as R,a as D,h as Q,m as C,d as k,b as S,F as Z,g as $,G as X,J as ne,j as ce,H as se,I as fe,af as me,v as Ne,ag as Ce,n as ae,p as re,_ as Le,Y as U,l as W,f as x,a2 as Re,Q as pe,R as _e,U as be}from"../chunks/vendor-31fcb76f.js";import{g as De}from"../chunks/navigation-bd39ff07.js";import{L as qe,S as Xe}from"../chunks/appStore-81b2c633.js";import{V as de}from"../chunks/ViewTitle-96aa6a7e.js";import{t as ge,g as Be,p as Ke,s as ee}from"../chunks/helpers-b17530cd.js";import{a as v,b as he,E as Fe}from"../chunks/exerciseCard-e37a03e6.js";import{F as Ve,I as ke,M as Ee,L as ve,P as We}from"../chunks/playPauseToggleIcon-c53c4cba.js";import{p as Me}from"../chunks/stores-aaabab89.js";import"../chunks/singletons-a6a7384f.js";const ze=()=>{const{subscribe:s,set:e}=oe(null);return{subscribe:s,setDb:t=>{const i=new DOMParser().parseFromString(t,"text/xml"),u=i.querySelector("parsererror");e(u||i)}}};var M=ze();const Ue=()=>({saveWorkout:async e=>new Promise(n=>{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"};let a="https://kalabaaz.pythonanywhere.com";a+="/api/workout/save",fetch(a,t).then(i=>{i.ok&&n()}).catch(i=>{console.error(i)})})});var Ge=Ue();const we=ie(M,s=>{if(!s)return[];const e=s.querySelector("exercises");return Array.from(e.children).map(n=>Object.seal({id:n.tagName,title:ge(n.tagName.replace("_"," "))}))},[]),le=(s=null)=>{const e=Object.preventExtensions({id:null,title:null,tabatas:3,prep_time:10,time_on:40,time_off:15,rest_time:60,with_equipment:!0,has_plank:!0,pathname:null,rules:{}}),{subscribe:n,set:t,update:a}=oe(e),i=c=>{c=Object.assign(e,c),we.subscribe(m=>{if(m.length){const _=Object.fromEntries(m.map(p=>[p.id,0]));c.rules=Object.preventExtensions(Object.assign(_,c.rules))}return!0})(),t(c)},u=(c,o)=>{let m=!1;return a(_=>(o&&!isNaN(o)&&(_.rules[c]=o),m=!0,_)),m},f=(c=null)=>(c||n(m=>c=m)(),Object.entries(c.rules).reduce((o,m)=>o+(isNaN(m[1])?0:m[1]),0)),l=(c=null)=>{c||n(p=>c=p)();const o=f(c);let m=0;return m+=c.prep_time,m+=c.time_on*o*c.tabatas,m+=c.time_off*(o-1)*c.tabatas,m+=c.rest_time*(c.tabatas-1),m},r=(c=null)=>{let o;return n(_=>o=_)(),c?o[c]:o},b=(c=null)=>{c||n(_=>c=_)();const o=Object.fromEntries(Object.entries(c));return o.rules=Object.fromEntries(Object.entries(c.rules)),o};return s&&i(s),{subscribe:n,set:i,get:r,clone:b,update:a,updateRule:u,getTotalTime:l,getTotalExercises:f}},He=ie(M,(s,e)=>{if(!s)return[];const n=s.querySelector("selection_rules");if(!n)return[];const t=[];Array.from(n.children).forEach(a=>{const i={id:a.tagName,title:ge(a.tagName.replace("_"," ")),tabatas:parseInt(a.getAttribute("tabatas")),rest_time:parseInt(a.getAttribute("rest_time")),time_on:parseInt(a.getAttribute("time_on")),time_off:parseInt(a.getAttribute("time_off")),prep_time:parseInt(a.getAttribute("prep_time"))||10},u=Array.from(a.children).map(f=>[f.tagName,parseInt(f.getAttribute("select"))]);i.rules=Object.fromEntries(u),t.push(le(i))}),e(t)},[]),Je=(s=le())=>{const e=Object.preventExtensions({meta:s?s.get():null,[v.EXERCISE]:[],[v.PLANK]:[]}),{subscribe:n,set:t,update:a}=oe(e),i=(p=le())=>{s=p,M.subscribe(h=>{if(!h)return;const g={};g.meta=l(s.get()),g[v.EXERCISE]=[],g[v.PLANK]=[];for(let T in g.meta.rules){if(!parseInt(g.meta.rules[T]))continue;const P=h.querySelector("exercises > "+T).children;g[v.EXERCISE]=g[v.EXERCISE].concat(o(P,g.meta.rules[T],!1,g.meta.with_equipment))}if(g.meta.with_equipment){const T=Math.random()>.5?1:-1;g[v.EXERCISE]=g[v.EXERCISE].sort((P,F)=>(P.band_pos-F.band_pos)*T)}if(g.meta.has_plank){const T=h.querySelector("planks");g[v.PLANK]=o(T.children,parseInt(T.getAttribute("select")),!0,g.meta.with_equipment)}t(g)})()},u=(p=!1)=>{a(d=>(d.meta.pathname||(d.meta.pathname=Be(10)),qe.setItem("workout",d),p===!0&&Ge.saveWorkout(d),d))},f=(p=null)=>{p||n(T=>p=T)();const d=p[v.EXERCISE].length;let h=0;return h+=p.meta.prep_time,h+=p.meta.time_on*d*p.meta.tabatas,h+=p.meta.time_off*(d-1)*p.meta.tabatas,h+=p.meta.rest_time*(p.meta.tabatas-1),h},l=(p=null)=>{p||n(g=>p=g.meta)()();const d=Object.fromEntries(Object.entries(p));return d.rules=Object.fromEntries(Object.entries(p.rules)),d},r=(p=-1,d=v.EXERCISE,h="replace")=>{a(g=>{const T=g[d][p];switch(h){case"delete":m(p,g[d]),d!==v.PLANK&&(g.meta.rules[T.region]-=1);break;case"replace":const P=c(p,g[d],d);P.length&&m(p,g[d],P);break}return g})},b=(p=-1,d=-1,h=v.EXERCISE)=>{p<0||a(g=>{const T=g[h].length;d==-1?d=T-1:d==T&&(d=0);const P=g[h].splice(d,1,g[h][p]);return g[h].splice(p,1,...P),g})},c=(p,d,h)=>{const g=d[p];if(!g)return[];const T=d.filter(K=>K.region===g.region).map(K=>K.name),P=Pe(M);let F=h;h==v.EXERCISE&&(F+=" > "+g.region);let q=P.querySelector(F);const te=Array.from(q.children).filter(K=>!T.includes(K.getAttribute("name")));return o(te,1,h==v.PLANK)},o=(p,d,h,g=!0)=>{p=p instanceof Array?p:Array.from(p),g===!1&&(p=p.filter(q=>parseInt(q.getAttribute("band_pos"))==0)),p.length>d&&(p=Ke(p,d));let T;_.subscribe(q=>T=q)();let F=[];for(let q in p){const te=Boolean(parseInt(p[q].getAttribute("has_lr"))),K=p[q].getAttribute("name"),B=he();if(B.type=h?v.PLANK:v.EXERCISE,B.name=K,B.display_name=K+(te?" (Right)":""),B.region=p[q].parentElement.tagName,B.target=p[q].getAttribute("target"),B.has_lr=te,B.band_pos=parseInt(p[q].getAttribute("band_pos")),B.band_pos_text=T[p[q].getAttribute("band_pos")],te){const ue=Object.assign(he(),B);ue.display_name=K+" (Left)",F.push(ue)}F.push(B)}return F},m=(p=-1,d=[],h=[])=>{const g=d[p],T=g.has_lr===!0?d.findIndex(P=>P.name==g.name&&P!==g):-1;T>-1&&(d.splice(T,1),p=d.indexOf(g)),h.length?d.splice(p,1,...h):d.splice(p,1)},_=ie(M,p=>{if(!p)return{};const d={},h=p.querySelector("band_legends");return Array.from(h.children).forEach(g=>{d[g.getAttribute("id")]=g.getAttribute("title")}),d},{});return{subscribe:n,set:t,update:a,save:u,cloneMeta:l,alterExercise:r,swapExercise:b,getTotalTime:f,get preset(){return s},set preset(p){i(p)}}};var j=Je();function Ye(s){let e,n;return e=new Ve({props:{id:Qe,title:"Customize "+s[0].title+" Workout",fieldsets:s[3]()}}),e.$on("change",s[1]),e.$on("click",s[2]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){A(e,t,a),n=!0},p(t,[a]){const i={};a&1&&(i.title="Customize "+t[0].title+" Workout"),e.$set(i)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}const Qe="workoutSettingsForm";function Ze(s,e,n){let t,a,i;V(s,j,_=>n(6,t=_)),V(s,we,_=>n(7,i=_));const u=(_,p)=>{const d=_.currentTarget.type==="checkbox"?_.currentTarget.checked:parseInt(_.currentTarget.value);if(!isNaN(d)){if(p){o.updateRule(_.currentTarget.name,d);const g=_.currentTarget.form.querySelector("input[name=total_exercises]");g.value=o.getTotalExercises(a)}else z(o,a[_.currentTarget.name]=d,a);const h=_.currentTarget.form.querySelector("input[name=total_time]");h.value=ee(o.getTotalTime(a))}},f=_=>{const p=_.currentTarget,d=Object.keys(c).includes(p.name),h=["has_plank","with_equipment"].includes(p.name);u(_,!d&&!h)},l=_=>{_.preventDefault();const p=new FormData(_.currentTarget.form);z(o,a.tabatas=parseInt(p.get("tabatas")),a),z(o,a.prep_time=parseInt(p.get("prep_time")),a),z(o,a.time_on=parseInt(p.get("time_on")),a),z(o,a.time_off=parseInt(p.get("time_off")),a),z(o,a.rest_time=parseInt(p.get("rest_time")),a);for(let d in a.rules)z(o,a.rules[d]=parseInt(p.get(d)),a);j.preset=o},r=_=>{_.currentTarget.name==="submit"&&l(_),n(5,m=!1)},b=()=>{const _=[];let p={legend:"Exercises",inputs:[]};return i.forEach(d=>{const h={label:d.title,type:"number",value:a.rules[d.id],id:d.id,name:d.id};p.inputs.push(h)}),p.inputs.push({label:"Total Exercises",type:"text",value:o.getTotalExercises(a),id:"total_exercises",name:"total_exercises",readonly:!0}),_.push(p),p={legend:"Time:",inputs:[]},Object.entries(c).forEach(d=>{const h={label:d[1],type:"number",value:a[d[0]],id:d[0],name:d[0]};p.inputs.push(h)}),p.inputs.push({label:"Total Time",type:"text",value:ee(o.getTotalTime(a)),id:"total_time",name:"total_time",readonly:!0}),_.push(p),p={legend:"Options:",inputs:[]},p.inputs.push({label:"Planks?",type:"slider",checked:a.has_plank,id:"has_plank",name:"has_plank"}),p.inputs.push({label:"Use Bands?",type:"slider",checked:a.with_equipment,id:"with_equipment",name:"with_equipment"}),_.push(p),p={inputs:[{label:"Generate",bindValue:!1,type:"submit",value:"Generate Workout",id:"submit",name:"submit"}]},_.push(p),_},c={prep_time:"Prep Time (seconds)",time_on:"Active Time (seconds)",time_off:"Rest Time (seconds)",rest_time:"Break Time (seconds)",tabatas:"Rounds"},o=le(t.meta);V(s,o,_=>n(0,a=_));let{open:m=!0}=e;return s.$$set=_=>{"open"in _&&n(5,m=_.open)},[a,f,r,b,o,m]}class xe extends G{constructor(e){super();H(this,e,Ze,Ye,J,{open:5})}}function $e(s,e,n){const t=s.slice();return t[10]=e[n],t}function Te(s){let e,n=s[10][1]+"",t,a,i,u,f,l;return{c(){e=L("span"),t=Y(n),a=N(),this.h()},l(r){e=R(r,"SPAN",{class:!0,"data-value":!0,"data-placeholder":!0});var b=D(e);t=Q(b,n),a=C(b),b.forEach(k),this.h()},h(){S(e,"class","sel-box-option svelte-6j4pg4"),S(e,"data-value",i=s[10][0]),S(e,"data-placeholder",u=s[10][1]),Z(e,"selected",s[0]===s[10][0])},m(r,b){$(r,e,b),X(e,t),X(e,a),f||(l=ne(e,"click",s[5]),f=!0)},p(r,b){b&8&&n!==(n=r[10][1]+"")&&ce(t,n),b&8&&i!==(i=r[10][0])&&S(e,"data-value",i),b&8&&u!==(u=r[10][1])&&S(e,"data-placeholder",u),b&9&&Z(e,"selected",r[0]===r[10][0])},d(r){r&&k(e),f=!1,l()}}}function et(s){let e,n,t,a,i,u,f,l=s[3],r=[];for(let b=0;b<l.length;b+=1)r[b]=Te($e(s,l,b));return{c(){e=L("div"),n=L("span"),t=Y(s[1]),a=N(),i=L("div");for(let b=0;b<r.length;b+=1)r[b].c();this.h()},l(b){e=R(b,"DIV",{class:!0,id:!0});var c=D(e);n=R(c,"SPAN",{class:!0,"data-label":!0});var o=D(n);t=Q(o,s[1]),o.forEach(k),a=C(c),i=R(c,"DIV",{class:!0});var m=D(i);for(let _=0;_<r.length;_+=1)r[_].l(m);m.forEach(k),c.forEach(k),this.h()},h(){S(n,"class","sel-placeholder svelte-6j4pg4"),S(n,"data-label",s[1]),S(i,"class","sel-box svelte-6j4pg4"),S(e,"class","sel svelte-6j4pg4"),S(e,"id",s[2]),Z(e,"active",s[4])},m(b,c){$(b,e,c),X(e,n),X(n,t),X(e,a),X(e,i);for(let o=0;o<r.length;o+=1)r[o].m(i,null);u||(f=ne(e,"click",s[6]),u=!0)},p(b,[c]){if(c&2&&ce(t,b[1]),c&2&&S(n,"data-label",b[1]),c&41){l=b[3];let o;for(o=0;o<l.length;o+=1){const m=$e(b,l,o);r[o]?r[o].p(m,c):(r[o]=Te(m),r[o].c(),r[o].m(i,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=l.length}c&4&&S(e,"id",b[2]),c&16&&Z(e,"active",b[4])},i:se,o:se,d(b){b&&k(e),fe(r,b),u=!1,f()}}}function tt(s,e,n){const t=me(),a=()=>{const m=document.getElementById(b);if(!m)return null;let _="";return m.querySelectorAll(".sel-box-option").forEach(p=>{p.dataset.value==c&&(_=p.dataset.label)}),_},i=m=>{const _=document.getElementById(b).querySelector(".sel-placeholder");_.textContent=m},u=m=>{m.currentTarget.dataset.value!=c&&(n(0,c=m.currentTarget.dataset.value),i(m.currentTarget.dataset.placeholder),t("change",c))},f=()=>{n(4,l=!l),t("open",l)};Ne(()=>{const m=a();m&&i(m)});let l=!1,{label:r,name:b,value:c,options:o}=e;return s.$$set=m=>{"label"in m&&n(1,r=m.label),"name"in m&&n(2,b=m.name),"value"in m&&n(0,c=m.value),"options"in m&&n(3,o=m.options)},[c,r,b,o,l,u,f]}class nt extends G{constructor(e){super();H(this,e,tt,et,J,{label:1,name:2,value:0,options:3})}}function Se(s,e,n){const t=s.slice();return t[11]=e[n],t[13]=n,t}function st(s){let e,n;return e=new ke({props:{buttons:typeof s[2]=="function"?s[2](s[1],s[13]):s[2]}}),e.$on("click",s[7]),e.$on("dblclick",s[8]),e.$on("mouseenter",s[9]),e.$on("mouseleave",s[10]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){A(e,t,a),n=!0},p(t,a){const i={};a&6&&(i.buttons=typeof t[2]=="function"?t[2](t[1],t[13]):t[2]),e.$set(i)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function Ie(s){let e,n,t,a,i,u;return n=new Fe({props:{name:s[11].display_name,completed:!1,region:s[11].region,target:s[11].target,band_pos:s[11].band_pos,band_pos_text:s[11].band_pos_text,$$slots:{default:[st]},$$scope:{ctx:s}}}),{c(){e=L("li"),I(n.$$.fragment),t=N(),this.h()},l(f){e=R(f,"LI",{draggable:!0,class:!0});var l=D(e);y(n.$$.fragment,l),t=C(l),l.forEach(k),this.h()},h(){S(e,"draggable",s[3]),S(e,"class","svelte-1i892xx"),Z(e,"grabbable",s[3])},m(f,l){$(f,e,l),A(n,e,null),X(e,t),a=!0,i||(u=ne(e,"dragstart",s[6]),i=!0)},p(f,l){const r={};l&2&&(r.name=f[11].display_name),l&2&&(r.region=f[11].region),l&2&&(r.target=f[11].target),l&2&&(r.band_pos=f[11].band_pos),l&2&&(r.band_pos_text=f[11].band_pos_text),l&16390&&(r.$$scope={dirty:l,ctx:f}),n.$set(r),(!a||l&8)&&S(e,"draggable",f[3]),l&8&&Z(e,"grabbable",f[3])},i(f){a||(E(n.$$.fragment,f),a=!0)},o(f){w(n.$$.fragment,f),a=!1},d(f){f&&k(e),O(n),i=!1,u()}}}function at(s){let e,n,t,a,i,u,f,l=s[1],r=[];for(let c=0;c<l.length;c+=1)r[c]=Ie(Se(s,l,c));const b=c=>w(r[c],1,1,()=>{r[c]=null});return{c(){e=L("h5"),n=Y(s[0]),t=N(),a=L("ol");for(let c=0;c<r.length;c+=1)r[c].c();this.h()},l(c){e=R(c,"H5",{class:!0});var o=D(e);n=Q(o,s[0]),o.forEach(k),t=C(c),a=R(c,"OL",{class:!0});var m=D(a);for(let _=0;_<r.length;_+=1)r[_].l(m);m.forEach(k),this.h()},h(){S(e,"class","svelte-1i892xx"),S(a,"class","svelte-1i892xx")},m(c,o){$(c,e,o),X(e,n),$(c,t,o),$(c,a,o);for(let m=0;m<r.length;m+=1)r[m].m(a,null);i=!0,u||(f=[ne(a,"dragover",Ce(s[4])),ne(a,"drop",s[5])],u=!0)},p(c,[o]){if((!i||o&1)&&ce(n,c[0]),o&14){l=c[1];let m;for(m=0;m<l.length;m+=1){const _=Se(c,l,m);r[m]?(r[m].p(_,o),E(r[m],1)):(r[m]=Ie(_),r[m].c(),E(r[m],1),r[m].m(a,null))}for(ae(),m=l.length;m<r.length;m+=1)b(m);re()}},i(c){if(!i){for(let o=0;o<l.length;o+=1)E(r[o]);i=!0}},o(c){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)w(r[o]);i=!1},d(c){c&&k(e),c&&k(t),c&&k(a),fe(r,c),u=!1,Le(f)}}}function rt(s,e,n){let{title:t,items:a,buttons:i}=e,{draggable:u=!0}=e;function f(_){U.call(this,s,_)}function l(_){U.call(this,s,_)}function r(_){U.call(this,s,_)}function b(_){U.call(this,s,_)}function c(_){U.call(this,s,_)}function o(_){U.call(this,s,_)}function m(_){U.call(this,s,_)}return s.$$set=_=>{"title"in _&&n(0,t=_.title),"items"in _&&n(1,a=_.items),"buttons"in _&&n(2,i=_.buttons),"draggable"in _&&n(3,u=_.draggable)},[t,a,i,u,f,l,r,b,c,o,m]}class ye extends G{constructor(e){super();H(this,e,rt,at,J,{title:0,items:1,buttons:2,draggable:3})}}function Ae(s){let e,n;return e=new ye({props:{title:"Planks",items:s[0][v.PLANK],draggable:s[2]>1,buttons:s[6]}}),e.$on("dragstart",s[3]),e.$on("drop",s[4]),e.$on("click",s[5]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){A(e,t,a),n=!0},p(t,a){const i={};a&1&&(i.items=t[0][v.PLANK]),e.$set(i)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function lt(s){let e,n,t,a;e=new ye({props:{title:"Exercises",items:s[0][v.EXERCISE],draggable:s[1]>1,buttons:s[6]}}),e.$on("dragstart",s[3]),e.$on("drop",s[4]),e.$on("click",s[5]);let i=s[0][v.PLANK].length>0&&s[0].meta.has_plank===!0&&Ae(s);return{c(){I(e.$$.fragment),n=N(),i&&i.c(),t=W()},l(u){y(e.$$.fragment,u),n=C(u),i&&i.l(u),t=W()},m(u,f){A(e,u,f),$(u,n,f),i&&i.m(u,f),$(u,t,f),a=!0},p(u,[f]){const l={};f&1&&(l.items=u[0][v.EXERCISE]),e.$set(l),u[0][v.PLANK].length>0&&u[0].meta.has_plank===!0?i?(i.p(u,f),f&1&&E(i,1)):(i=Ae(u),i.c(),E(i,1),i.m(t.parentNode,t)):i&&(ae(),w(i,1,1,()=>{i=null}),re())},i(u){a||(E(e.$$.fragment,u),E(i),a=!0)},o(u){w(e.$$.fragment,u),w(i),a=!1},d(u){O(e,u),u&&k(n),i&&i.d(u),u&&k(t)}}}function ot(s,e,n){let t;V(s,j,c=>n(0,t=c));let a=t[v.EXERCISE].length,i=t[v.PLANK].length,u=null;return[t,a,i,c=>{u=c.currentTarget,c.dataTransfer.effectAllowed="move"},c=>{c.preventDefault();const o=c.path.indexOf(u.parentNode);if(o<1)return;const m=c.path[o-1];if(u===m)return;const _=Array.from(u.parentNode.children);j.swapExercise(_.indexOf(u),_.indexOf(m),v.EXERCISE)},c=>{const o=c.currentTarget.dataset,m=parseInt(o.id);switch(o.action){case"up":case"down":j.swapExercise(m,m+(o.action=="down"?1:-1),o.type);break;case"delete":case"replace":j.alterExercise(m,o.type,o.action);break}},(c,o)=>{const m=c.type===v.PLANK?i>1:a>1,_=c.type===v.PLANK?!1:a>1,p={"data-id":o,"data-type":c.type};return[{icon:"bi bi-arrow-repeat",title:"Replace Exercise",disabled:!1,data:Object.assign({"data-action":"replace"},p)},{icon:"bi bi-arrow-up-circle",title:"Move Up",disabled:!m,data:Object.assign({"data-action":"up"},p)},{icon:"bi bi-arrow-down-circle",title:"Move Down",disabled:!m,data:Object.assign({"data-action":"down"},p)},{icon:"bi bi-trash",title:"Trash",disabled:!_,data:Object.assign({"data-action":"delete"},p)}]}]}class it extends G{constructor(e){super();H(this,e,ot,lt,J,{})}}function Oe(s){let e,n,t,a,i,u,f,l,r,b,c;return e=new Ee({props:{click:s[4],$$slots:{default:[ct]},$$scope:{ctx:s}}}),a=new ke({props:{buttons:s[5]()}}),a.$on("click",s[3]),f=new it({}),r=new Ee({props:{click:s[4],$$slots:{default:[ut]},$$scope:{ctx:s}}}),{c(){n=L("div"),I(e.$$.fragment),t=N(),i=L("div"),I(a.$$.fragment),u=N(),I(f.$$.fragment),l=N(),b=L("div"),I(r.$$.fragment),this.h()},l(o){n=R(o,"DIV",{style:!0});var m=D(n);y(e.$$.fragment,m),t=C(o),i=R(o,"DIV",{style:!0});var _=D(i);y(a.$$.fragment,_),u=C(o),y(f.$$.fragment,o),l=C(o),b=R(o,"DIV",{style:!0});var p=D(b);y(r.$$.fragment,p),this.h()},h(){x(n,"display","contents"),x(n,"--theme-icon-size",".4rem"),x(i,"display","contents"),x(i,"--theme-icon-size","1.6rem"),x(b,"display","contents"),x(b,"--theme-icon-size",".3rem")},m(o,m){$(o,n,m),A(e,n,null),$(o,t,m),$(o,i,m),A(a,i,null),$(o,u,m),A(f,o,m),$(o,l,m),$(o,b,m),A(r,b,null),c=!0},p(o,m){const _={};m&8194&&(_.$$scope={dirty:m,ctx:o}),e.$set(_);const p={};m&8194&&(p.$$scope={dirty:m,ctx:o}),r.$set(p)},i(o){c||(E(e.$$.fragment,o),E(a.$$.fragment,o),E(f.$$.fragment,o),E(r.$$.fragment,o),c=!0)},o(o){w(e.$$.fragment,o),w(a.$$.fragment,o),w(f.$$.fragment,o),w(r.$$.fragment,o),c=!1},d(o){o&&k(n),O(e,o),o&&k(t),o&&k(i),O(a,o),o&&k(u),O(f,o),o&&k(l),o&&k(b),O(r,o)}}}function ct(s){let e,n;return e=new ve({props:{label:"Total Time",value:ee(j.getTotalTime(s[1]))}}),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){A(e,t,a),n=!0},p(t,a){const i={};a&2&&(i.value=ee(j.getTotalTime(t[1]))),e.$set(i)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ut(s){let e,n;return e=new ve({props:{label:"Total Time",value:ee(j.getTotalTime(s[1]))}}),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){A(e,t,a),n=!0},p(t,a){const i={};a&2&&(i.value=ee(j.getTotalTime(t[1]))),e.$set(i)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ft(s){let e,n,t,a,i,u;e=new de({props:{title:""+((s[1].meta.title?s[1].meta.title:"Create")+" Workout")}}),t=new nt({props:{label:"Presets",name:"preset",value:s[1].meta.id,options:s[2].map(je)}}),t.$on("change",s[7]),t.$on("open",s[8]);let f=!s[0]&&s[1].exercises.length&&Oe(s);return{c(){I(e.$$.fragment),n=N(),I(t.$$.fragment),a=N(),f&&f.c(),i=W()},l(l){y(e.$$.fragment,l),n=C(l),y(t.$$.fragment,l),a=C(l),f&&f.l(l),i=W()},m(l,r){A(e,l,r),$(l,n,r),A(t,l,r),$(l,a,r),f&&f.m(l,r),$(l,i,r),u=!0},p(l,[r]){const b={};r&2&&(b.title=""+((l[1].meta.title?l[1].meta.title:"Create")+" Workout")),e.$set(b);const c={};r&2&&(c.value=l[1].meta.id),r&4&&(c.options=l[2].map(je)),t.$set(c),!l[0]&&l[1].exercises.length?f?(f.p(l,r),r&3&&E(f,1)):(f=Oe(l),f.c(),E(f,1),f.m(i.parentNode,i)):f&&(ae(),w(f,1,1,()=>{f=null}),re())},i(l){u||(E(e.$$.fragment,l),E(t.$$.fragment,l),E(f),u=!0)},o(l){w(e.$$.fragment,l),w(t.$$.fragment,l),w(f),u=!1},d(l){O(e,l),l&&k(n),O(t,l),l&&k(a),f&&f.d(l),l&&k(i)}}}const je=s=>[s.get("id"),s.get("title")];function mt(s,e,n){let t,a,i;V(s,j,d=>n(1,t=d)),V(s,Me,d=>n(9,a=d)),V(s,He,d=>n(2,i=d));let u,{settingsOpen:f}=e;const l=me(),r=d=>{switch(d.currentTarget.dataset.action){case"reset":j.preset=j.preset;break;case"share":c();break;case"settings_open":n(6,f=!0);break}},b=()=>navigator.share&&navigator.canShare(),c=async()=>{j.save(!0);const d={title:`Sweat ${t.meta.title} Workout`,text:"This the link to your saved workout.",url:`${a.url.origin}/routine/tabata/${t.meta.pathname}`};b()?window.navigator.share(d).catch(h=>{console.error(h)}):navigator.clipboard&&navigator.clipboard.writeText(d.url).then(()=>{console.info("Show copied notification here")}).catch(h=>{console.error(h)})},o=()=>{j.save(!1),l("workout")},m=()=>[{icon:"bi bi-bootstrap-reboot",title:"Reset",data:{"data-action":"reset"}},{component:We,props:{}},{icon:`bi bi-${b()?"share-fill":"link"}`,title:"Share",data:{"data-action":"share"}},{icon:"bi bi-gear-wide-connected",title:"Timer Settings",data:{"data-action":"settings_open"}}],_=d=>j.preset=i.find(h=>h.get("id")==d.detail),p=d=>n(0,u=d.detail);return s.$$set=d=>{"settingsOpen"in d&&n(6,f=d.settingsOpen)},[u,t,i,r,o,m,f,_,p]}class pt extends G{constructor(e){super();H(this,e,mt,ft,J,{settingsOpen:6})}}function _t(s){let e,n,t,a,i,u,f,l;return{c(){e=L("h2"),n=Y("Unable to connect to database"),t=N(),a=L("p"),i=Y("This is embarrassing! I'm unable to connect to the database."),u=N(),f=L("p"),l=Y("Please try again later. Sorry!"),this.h()},l(r){e=R(r,"H2",{class:!0});var b=D(e);n=Q(b,"Unable to connect to database"),b.forEach(k),t=C(r),a=R(r,"P",{});var c=D(a);i=Q(c,"This is embarrassing! I'm unable to connect to the database."),c.forEach(k),u=C(r),f=R(r,"P",{});var o=D(f);l=Q(o,"Please try again later. Sorry!"),o.forEach(k),this.h()},h(){S(e,"class","center error")},m(r,b){$(r,e,b),X(e,n),$(r,t,b),$(r,a,b),X(a,i),$(r,u,b),$(r,f,b),X(f,l)},p:se,i:se,o:se,d(r){r&&k(e),r&&k(t),r&&k(a),r&&k(u),r&&k(f)}}}function bt(s){let e,n,t,a;const i=[gt,dt],u=[];function f(l,r){return l[0]?0:1}return e=f(s),n=u[e]=i[e](s),{c(){n.c(),t=W()},l(l){n.l(l),t=W()},m(l,r){u[e].m(l,r),$(l,t,r),a=!0},p(l,r){let b=e;e=f(l),e===b?u[e].p(l,r):(ae(),w(u[b],1,1,()=>{u[b]=null}),re(),n=u[e],n?n.p(l,r):(n=u[e]=i[e](l),n.c()),E(n,1),n.m(t.parentNode,t))},i(l){a||(E(n),a=!0)},o(l){w(n),a=!1},d(l){u[e].d(l),l&&k(t)}}}function dt(s){let e,n,t;function a(u){s[5](u)}let i={};return s[0]!==void 0&&(i.settingsOpen=s[0]),e=new pt({props:i}),pe.push(()=>_e(e,"settingsOpen",a)),e.$on("workout",s[2]),{c(){I(e.$$.fragment)},l(u){y(e.$$.fragment,u)},m(u,f){A(e,u,f),t=!0},p(u,f){const l={};!n&&f&1&&(n=!0,l.settingsOpen=u[0],be(()=>n=!1)),e.$set(l)},i(u){t||(E(e.$$.fragment,u),t=!0)},o(u){w(e.$$.fragment,u),t=!1},d(u){O(e,u)}}}function gt(s){let e,n,t,a,i;e=new de({props:{title:"Customize Workout"}});function u(l){s[4](l)}let f={};return s[0]!==void 0&&(f.open=s[0]),t=new xe({props:f}),pe.push(()=>_e(t,"open",u)),{c(){I(e.$$.fragment),n=N(),I(t.$$.fragment)},l(l){y(e.$$.fragment,l),n=C(l),y(t.$$.fragment,l)},m(l,r){A(e,l,r),$(l,n,r),A(t,l,r),i=!0},p(l,r){const b={};!a&&r&1&&(a=!0,b.open=l[0],be(()=>a=!1)),t.$set(b)},i(l){i||(E(e.$$.fragment,l),E(t.$$.fragment,l),i=!0)},o(l){w(e.$$.fragment,l),w(t.$$.fragment,l),i=!1},d(l){O(e,l),l&&k(n),O(t,l)}}}function ht(s){let e,n,t,a,i;const u=[bt,_t],f=[];function l(r,b){return r[1]?0:1}return n=l(s),t=f[n]=u[n](s),{c(){e=N(),t.c(),a=W(),this.h()},l(r){Re('[data-svelte="svelte-8h4qcl"]',document.head).forEach(k),e=C(r),t.l(r),a=W(),this.h()},h(){document.title="SWEAT Workout"},m(r,b){$(r,e,b),f[n].m(r,b),$(r,a,b),i=!0},p(r,[b]){let c=n;n=l(r),n===c?f[n].p(r,b):(ae(),w(f[c],1,1,()=>{f[c]=null}),re(),t=f[n],t?t.p(r,b):(t=f[n]=u[n](r),t.c()),E(t,1),t.m(a.parentNode,a))},i(r){i||(E(t),i=!0)},o(r){w(t),i=!1},d(r){r&&k(e),f[n].d(r),r&&k(a)}}}async function Ot({fetch:s}){const e={xml:null};let n=!1;if(M.subscribe(a=>{n=a!==null})(),!n){const a=await s("/data/workout_list.xml");a.ok&&(e.xml=await a.text())}return{props:e}}function kt(s,e,n){let t;V(s,M,r=>n(1,t=r));let{xml:a}=e;const i=()=>{Xe.setItem("routine",[]),De("/routine/tabata")};a&&M.setDb(a);let u=!1;function f(r){u=r,n(0,u)}function l(r){u=r,n(0,u)}return s.$$set=r=>{"xml"in r&&n(3,a=r.xml)},[u,t,i,a,f,l]}class jt extends G{constructor(e){super();H(this,e,kt,ht,J,{xml:3})}}export{jt as default,Ot as load};
