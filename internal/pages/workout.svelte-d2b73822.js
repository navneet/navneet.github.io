import{D as oe,a3 as ie,ae as Ne,S as U,i as G,s as J,w as I,x as y,y as A,q as E,o as w,B as O,M as V,O as z,e as L,t as Y,k as N,c as R,a as D,h as Q,m as C,d as h,b as T,F as Z,g as S,G as X,J as ne,j as ce,H as se,I as fe,af as me,v as Ce,ag as Le,n as re,p as ae,_ as Re,Y as H,l as W,f as x,a2 as De,Q as pe,R as _e,U as de}from"../chunks/vendor-5de77269.js";import{g as qe}from"../chunks/navigation-bd39ff07.js";import{L as Xe,A as be,S as Be}from"../chunks/appStore-a9303580.js";import{V as ge}from"../chunks/ViewTitle-5b424108.js";import{t as he,g as Ke,p as Fe,s as ee}from"../chunks/helpers-c419cb44.js";import{a as v,b as ke,E as Ve}from"../chunks/exerciseCard-175ef08d.js";import{F as We,I as Ee,M as ve,L as we,P as Me}from"../chunks/playPauseToggleIcon-69d4c21c.js";import"../chunks/singletons-a6a7384f.js";const ze=()=>{const{subscribe:s,set:e}=oe(null);return{subscribe:s,setDb:t=>{const c=new DOMParser().parseFromString(t,"text/xml"),f=c.querySelector("parsererror");e(f||c)}}};var M=ze();const He=()=>({saveWorkout:async e=>new Promise(n=>{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"};let r="https://kalabaaz.pythonanywhere.com";r+="/api/workout/save",fetch(r,t).then(c=>{c.ok&&n()}).catch(c=>{console.error(c)})})});var Ue=He();const Se=ie(M,s=>{if(!s)return[];const e=s.querySelector("exercises");return Array.from(e.children).map(n=>Object.seal({id:n.tagName,title:he(n.tagName.replace("_"," "))}))},[]),le=(s=null)=>{const e=Object.preventExtensions({id:null,title:null,tabatas:3,prep_time:10,time_on:40,time_off:15,rest_time:60,with_equipment:!0,has_plank:!0,pathname:null,rules:{}}),{subscribe:n,set:t,update:r}=oe(e),c=i=>{i=Object.assign(e,i),Se.subscribe(p=>{if(p.length){const _=Object.fromEntries(p.map(u=>[u.id,0]));i.rules=Object.preventExtensions(Object.assign(_,i.rules))}return!0})(),t(i)},f=(i,o)=>{let p=!1;return r(_=>(o&&!isNaN(o)&&(_.rules[i]=o),p=!0,_)),p},m=(i=null)=>(i||n(p=>i=p)(),Object.entries(i.rules).reduce((o,p)=>o+(isNaN(p[1])?0:p[1]),0)),l=(i=null)=>{i||n(u=>i=u)();const o=m(i);let p=0;return p+=i.prep_time,p+=i.time_on*o*i.tabatas,p+=i.time_off*(o-1)*i.tabatas,p+=i.rest_time*(i.tabatas-1),p},a=(i=null)=>{let o;return n(_=>o=_)(),i?o[i]:o},d=(i=null)=>{i||n(_=>i=_)();const o=Object.fromEntries(Object.entries(i));return o.rules=Object.fromEntries(Object.entries(i.rules)),o};return s&&c(s),{subscribe:n,set:c,get:a,clone:d,update:r,updateRule:f,getTotalTime:l,getTotalExercises:m}},Ge=ie(M,(s,e)=>{if(!s)return[];const n=s.querySelector("selection_rules");if(!n)return[];const t=[];Array.from(n.children).forEach(r=>{const c={id:r.tagName,title:he(r.tagName.replace("_"," ")),tabatas:parseInt(r.getAttribute("tabatas")),rest_time:parseInt(r.getAttribute("rest_time")),time_on:parseInt(r.getAttribute("time_on")),time_off:parseInt(r.getAttribute("time_off")),prep_time:parseInt(r.getAttribute("prep_time"))||10},f=Array.from(r.children).map(m=>[m.tagName,parseInt(m.getAttribute("select"))]);c.rules=Object.fromEntries(f),t.push(le(c))}),e(t)},[]),Je=(s=le())=>{const e=Object.preventExtensions({meta:s?s.get():null,[v.EXERCISE]:[],[v.PLANK]:[]}),{subscribe:n,set:t,update:r}=oe(e),c=(u=le())=>{s=u,M.subscribe(k=>{if(!k)return;const g={};g.meta=l(s.get()),g[v.EXERCISE]=[],g[v.PLANK]=[];for(let $ in g.meta.rules){if(!parseInt(g.meta.rules[$]))continue;const P=k.querySelector("exercises > "+$).children;g[v.EXERCISE]=g[v.EXERCISE].concat(o(P,g.meta.rules[$],!1,g.meta.with_equipment))}if(g.meta.with_equipment){const $=Math.random()>.5?1:-1;g[v.EXERCISE]=g[v.EXERCISE].sort((P,F)=>(P.band_pos-F.band_pos)*$)}if(g.meta.has_plank){const $=k.querySelector("planks");g[v.PLANK]=o($.children,parseInt($.getAttribute("select")),!0,g.meta.with_equipment)}t(g)})()},f=(u=!1)=>{r(b=>(b.meta.pathname||(b.meta.pathname=Ke(10)),Xe.setItem("workout",b),u===!0&&Ue.saveWorkout(b),b))},m=(u=null)=>{u||n($=>u=$)();const b=u[v.EXERCISE].length;let k=0;return k+=u.meta.prep_time,k+=u.meta.time_on*b*u.meta.tabatas,k+=u.meta.time_off*(b-1)*u.meta.tabatas,k+=u.meta.rest_time*(u.meta.tabatas-1),k},l=(u=null)=>{u||n(g=>u=g.meta)()();const b=Object.fromEntries(Object.entries(u));return b.rules=Object.fromEntries(Object.entries(u.rules)),b},a=(u=-1,b=v.EXERCISE,k="replace")=>{r(g=>{const $=g[b][u];switch(k){case"delete":p(u,g[b]),b!==v.PLANK&&(g.meta.rules[$.region]-=1);break;case"replace":const P=i(u,g[b],b);P.length&&p(u,g[b],P);break}return g})},d=(u=-1,b=-1,k=v.EXERCISE)=>{u<0||r(g=>{const $=g[k].length;b==-1?b=$-1:b==$&&(b=0);const P=g[k].splice(b,1,g[k][u]);return g[k].splice(u,1,...P),g})},i=(u,b,k)=>{const g=b[u];if(!g)return[];const $=b.filter(K=>K.region===g.region).map(K=>K.name),P=Ne(M);let F=k;k==v.EXERCISE&&(F+=" > "+g.region);let q=P.querySelector(F);const te=Array.from(q.children).filter(K=>!$.includes(K.getAttribute("name")));return o(te,1,k==v.PLANK)},o=(u,b,k,g=!0)=>{u=u instanceof Array?u:Array.from(u),g===!1&&(u=u.filter(q=>parseInt(q.getAttribute("band_pos"))==0)),u.length>b&&(u=Fe(u,b));let $;_.subscribe(q=>$=q)();let F=[];for(let q in u){const te=Boolean(parseInt(u[q].getAttribute("has_lr"))),K=u[q].getAttribute("name"),B=ke();if(B.type=k?v.PLANK:v.EXERCISE,B.name=K,B.display_name=K+(te?" (Right)":""),B.region=u[q].parentElement.tagName,B.target=u[q].getAttribute("target"),B.has_lr=te,B.band_pos=parseInt(u[q].getAttribute("band_pos")),B.band_pos_text=$[u[q].getAttribute("band_pos")],te){const ue=Object.assign(ke(),B);ue.display_name=K+" (Left)",F.push(ue)}F.push(B)}return F},p=(u=-1,b=[],k=[])=>{const g=b[u],$=g.has_lr===!0?b.findIndex(P=>P.name==g.name&&P!==g):-1;$>-1&&(b.splice($,1),u=b.indexOf(g)),k.length?b.splice(u,1,...k):b.splice(u,1)},_=ie(M,u=>{if(!u)return{};const b={},k=u.querySelector("band_legends");return Array.from(k.children).forEach(g=>{b[g.getAttribute("id")]=g.getAttribute("title")}),b},{});return{subscribe:n,set:t,update:r,save:f,cloneMeta:l,alterExercise:a,swapExercise:d,getTotalTime:m,get preset(){return s},set preset(u){c(u)}}};var j=Je();function Ye(s){let e,n;return e=new We({props:{id:Qe,title:"Customize "+s[0].title+" Workout",fieldsets:s[3]()}}),e.$on("change",s[1]),e.$on("click",s[2]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,[r]){const c={};r&1&&(c.title="Customize "+t[0].title+" Workout"),e.$set(c)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}const Qe="workoutSettingsForm";function Ze(s,e,n){let t,r,c;V(s,j,_=>n(6,t=_)),V(s,Se,_=>n(7,c=_));const f=(_,u)=>{const b=_.currentTarget.type==="checkbox"?_.currentTarget.checked:parseInt(_.currentTarget.value);if(!isNaN(b)){if(u){o.updateRule(_.currentTarget.name,b);const g=_.currentTarget.form.querySelector("input[name=total_exercises]");g.value=o.getTotalExercises(r)}else z(o,r[_.currentTarget.name]=b,r);const k=_.currentTarget.form.querySelector("input[name=total_time]");k.value=ee(o.getTotalTime(r))}},m=_=>{const u=_.currentTarget,b=Object.keys(i).includes(u.name),k=["has_plank","with_equipment"].includes(u.name);f(_,!b&&!k)},l=_=>{_.preventDefault();const u=new FormData(_.currentTarget.form);z(o,r.tabatas=parseInt(u.get("tabatas")),r),z(o,r.prep_time=parseInt(u.get("prep_time")),r),z(o,r.time_on=parseInt(u.get("time_on")),r),z(o,r.time_off=parseInt(u.get("time_off")),r),z(o,r.rest_time=parseInt(u.get("rest_time")),r);for(let b in r.rules)z(o,r.rules[b]=parseInt(u.get(b)),r);j.preset=o},a=_=>{_.currentTarget.name==="submit"&&l(_),n(5,p=!1)},d=()=>{const _=[];let u={legend:"Exercises",inputs:[]};return c.forEach(b=>{const k={label:b.title,type:"number",value:r.rules[b.id],id:b.id,name:b.id};u.inputs.push(k)}),u.inputs.push({label:"Total Exercises",type:"text",value:o.getTotalExercises(r),id:"total_exercises",name:"total_exercises",readonly:!0}),_.push(u),u={legend:"Time:",inputs:[]},Object.entries(i).forEach(b=>{const k={label:b[1],type:"number",value:r[b[0]],id:b[0],name:b[0]};u.inputs.push(k)}),u.inputs.push({label:"Total Time",type:"text",value:ee(o.getTotalTime(r)),id:"total_time",name:"total_time",readonly:!0}),_.push(u),u={legend:"Options:",inputs:[]},u.inputs.push({label:"Planks?",type:"slider",checked:r.has_plank,id:"has_plank",name:"has_plank"}),u.inputs.push({label:"Use Bands?",type:"slider",checked:r.with_equipment,id:"with_equipment",name:"with_equipment"}),_.push(u),u={inputs:[{label:"Generate",bindValue:!1,type:"submit",value:"Generate Workout",id:"submit",name:"submit"}]},_.push(u),_},i={prep_time:"Prep Time (seconds)",time_on:"Active Time (seconds)",time_off:"Rest Time (seconds)",rest_time:"Break Time (seconds)",tabatas:"Rounds"},o=le(t.meta);V(s,o,_=>n(0,r=_));let{open:p=!0}=e;return s.$$set=_=>{"open"in _&&n(5,p=_.open)},[r,m,a,d,o,p]}class xe extends U{constructor(e){super();G(this,e,Ze,Ye,J,{open:5})}}function $e(s,e,n){const t=s.slice();return t[10]=e[n],t}function Te(s){let e,n=s[10][1]+"",t,r,c,f,m,l;return{c(){e=L("span"),t=Y(n),r=N(),this.h()},l(a){e=R(a,"SPAN",{class:!0,"data-value":!0,"data-placeholder":!0});var d=D(e);t=Q(d,n),r=C(d),d.forEach(h),this.h()},h(){T(e,"class","sel-box-option svelte-6j4pg4"),T(e,"data-value",c=s[10][0]),T(e,"data-placeholder",f=s[10][1]),Z(e,"selected",s[0]===s[10][0])},m(a,d){S(a,e,d),X(e,t),X(e,r),m||(l=ne(e,"click",s[5]),m=!0)},p(a,d){d&8&&n!==(n=a[10][1]+"")&&ce(t,n),d&8&&c!==(c=a[10][0])&&T(e,"data-value",c),d&8&&f!==(f=a[10][1])&&T(e,"data-placeholder",f),d&9&&Z(e,"selected",a[0]===a[10][0])},d(a){a&&h(e),m=!1,l()}}}function et(s){let e,n,t,r,c,f,m,l=s[3],a=[];for(let d=0;d<l.length;d+=1)a[d]=Te($e(s,l,d));return{c(){e=L("div"),n=L("span"),t=Y(s[1]),r=N(),c=L("div");for(let d=0;d<a.length;d+=1)a[d].c();this.h()},l(d){e=R(d,"DIV",{class:!0,id:!0});var i=D(e);n=R(i,"SPAN",{class:!0,"data-label":!0});var o=D(n);t=Q(o,s[1]),o.forEach(h),r=C(i),c=R(i,"DIV",{class:!0});var p=D(c);for(let _=0;_<a.length;_+=1)a[_].l(p);p.forEach(h),i.forEach(h),this.h()},h(){T(n,"class","sel-placeholder svelte-6j4pg4"),T(n,"data-label",s[1]),T(c,"class","sel-box svelte-6j4pg4"),T(e,"class","sel svelte-6j4pg4"),T(e,"id",s[2]),Z(e,"active",s[4])},m(d,i){S(d,e,i),X(e,n),X(n,t),X(e,r),X(e,c);for(let o=0;o<a.length;o+=1)a[o].m(c,null);f||(m=ne(e,"click",s[6]),f=!0)},p(d,[i]){if(i&2&&ce(t,d[1]),i&2&&T(n,"data-label",d[1]),i&41){l=d[3];let o;for(o=0;o<l.length;o+=1){const p=$e(d,l,o);a[o]?a[o].p(p,i):(a[o]=Te(p),a[o].c(),a[o].m(c,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=l.length}i&4&&T(e,"id",d[2]),i&16&&Z(e,"active",d[4])},i:se,o:se,d(d){d&&h(e),fe(a,d),f=!1,m()}}}function tt(s,e,n){const t=me(),r=()=>{const p=document.getElementById(d);if(!p)return null;let _="";return p.querySelectorAll(".sel-box-option").forEach(u=>{u.dataset.value==i&&(_=u.dataset.label)}),_},c=p=>{const _=document.getElementById(d).querySelector(".sel-placeholder");_.textContent=p},f=p=>{p.currentTarget.dataset.value!=i&&(n(0,i=p.currentTarget.dataset.value),c(p.currentTarget.dataset.placeholder),t("change",i))},m=()=>{n(4,l=!l),t("open",l)};Ce(()=>{const p=r();p&&c(p)});let l=!1,{label:a,name:d,value:i,options:o}=e;return s.$$set=p=>{"label"in p&&n(1,a=p.label),"name"in p&&n(2,d=p.name),"value"in p&&n(0,i=p.value),"options"in p&&n(3,o=p.options)},[i,a,d,o,l,f,m]}class nt extends U{constructor(e){super();G(this,e,tt,et,J,{label:1,name:2,value:0,options:3})}}function Ie(s,e,n){const t=s.slice();return t[11]=e[n],t[13]=n,t}function st(s){let e,n;return e=new Ee({props:{buttons:typeof s[2]=="function"?s[2](s[1],s[13]):s[2]}}),e.$on("click",s[7]),e.$on("dblclick",s[8]),e.$on("mouseenter",s[9]),e.$on("mouseleave",s[10]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&6&&(c.buttons=typeof t[2]=="function"?t[2](t[1],t[13]):t[2]),e.$set(c)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ye(s){let e,n,t,r,c,f;return n=new Ve({props:{name:s[11].display_name,completed:!1,region:s[11].region,target:s[11].target,band_pos:s[11].band_pos,band_pos_text:s[11].band_pos_text,$$slots:{default:[st]},$$scope:{ctx:s}}}),{c(){e=L("li"),I(n.$$.fragment),t=N(),this.h()},l(m){e=R(m,"LI",{draggable:!0,class:!0});var l=D(e);y(n.$$.fragment,l),t=C(l),l.forEach(h),this.h()},h(){T(e,"draggable",s[3]),T(e,"class","svelte-1i892xx"),Z(e,"grabbable",s[3])},m(m,l){S(m,e,l),A(n,e,null),X(e,t),r=!0,c||(f=ne(e,"dragstart",s[6]),c=!0)},p(m,l){const a={};l&2&&(a.name=m[11].display_name),l&2&&(a.region=m[11].region),l&2&&(a.target=m[11].target),l&2&&(a.band_pos=m[11].band_pos),l&2&&(a.band_pos_text=m[11].band_pos_text),l&16390&&(a.$$scope={dirty:l,ctx:m}),n.$set(a),(!r||l&8)&&T(e,"draggable",m[3]),l&8&&Z(e,"grabbable",m[3])},i(m){r||(E(n.$$.fragment,m),r=!0)},o(m){w(n.$$.fragment,m),r=!1},d(m){m&&h(e),O(n),c=!1,f()}}}function rt(s){let e,n,t,r,c,f,m,l=s[1],a=[];for(let i=0;i<l.length;i+=1)a[i]=ye(Ie(s,l,i));const d=i=>w(a[i],1,1,()=>{a[i]=null});return{c(){e=L("h5"),n=Y(s[0]),t=N(),r=L("ol");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){e=R(i,"H5",{class:!0});var o=D(e);n=Q(o,s[0]),o.forEach(h),t=C(i),r=R(i,"OL",{class:!0});var p=D(r);for(let _=0;_<a.length;_+=1)a[_].l(p);p.forEach(h),this.h()},h(){T(e,"class","svelte-1i892xx"),T(r,"class","svelte-1i892xx")},m(i,o){S(i,e,o),X(e,n),S(i,t,o),S(i,r,o);for(let p=0;p<a.length;p+=1)a[p].m(r,null);c=!0,f||(m=[ne(r,"dragover",Le(s[4])),ne(r,"drop",s[5])],f=!0)},p(i,[o]){if((!c||o&1)&&ce(n,i[0]),o&14){l=i[1];let p;for(p=0;p<l.length;p+=1){const _=Ie(i,l,p);a[p]?(a[p].p(_,o),E(a[p],1)):(a[p]=ye(_),a[p].c(),E(a[p],1),a[p].m(r,null))}for(re(),p=l.length;p<a.length;p+=1)d(p);ae()}},i(i){if(!c){for(let o=0;o<l.length;o+=1)E(a[o]);c=!0}},o(i){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)w(a[o]);c=!1},d(i){i&&h(e),i&&h(t),i&&h(r),fe(a,i),f=!1,Re(m)}}}function at(s,e,n){let{title:t,items:r,buttons:c}=e,{draggable:f=!0}=e;function m(_){H.call(this,s,_)}function l(_){H.call(this,s,_)}function a(_){H.call(this,s,_)}function d(_){H.call(this,s,_)}function i(_){H.call(this,s,_)}function o(_){H.call(this,s,_)}function p(_){H.call(this,s,_)}return s.$$set=_=>{"title"in _&&n(0,t=_.title),"items"in _&&n(1,r=_.items),"buttons"in _&&n(2,c=_.buttons),"draggable"in _&&n(3,f=_.draggable)},[t,r,c,f,m,l,a,d,i,o,p]}class Ae extends U{constructor(e){super();G(this,e,at,rt,J,{title:0,items:1,buttons:2,draggable:3})}}function Oe(s){let e,n;return e=new Ae({props:{title:"Planks",items:s[0][v.PLANK],draggable:s[2]>1,buttons:s[6]}}),e.$on("dragstart",s[3]),e.$on("drop",s[4]),e.$on("click",s[5]),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&1&&(c.items=t[0][v.PLANK]),e.$set(c)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function lt(s){let e,n,t,r;e=new Ae({props:{title:"Exercises",items:s[0][v.EXERCISE],draggable:s[1]>1,buttons:s[6]}}),e.$on("dragstart",s[3]),e.$on("drop",s[4]),e.$on("click",s[5]);let c=s[0][v.PLANK].length>0&&s[0].meta.has_plank===!0&&Oe(s);return{c(){I(e.$$.fragment),n=N(),c&&c.c(),t=W()},l(f){y(e.$$.fragment,f),n=C(f),c&&c.l(f),t=W()},m(f,m){A(e,f,m),S(f,n,m),c&&c.m(f,m),S(f,t,m),r=!0},p(f,[m]){const l={};m&1&&(l.items=f[0][v.EXERCISE]),e.$set(l),f[0][v.PLANK].length>0&&f[0].meta.has_plank===!0?c?(c.p(f,m),m&1&&E(c,1)):(c=Oe(f),c.c(),E(c,1),c.m(t.parentNode,t)):c&&(re(),w(c,1,1,()=>{c=null}),ae())},i(f){r||(E(e.$$.fragment,f),E(c),r=!0)},o(f){w(e.$$.fragment,f),w(c),r=!1},d(f){O(e,f),f&&h(n),c&&c.d(f),f&&h(t)}}}function ot(s,e,n){let t;V(s,j,i=>n(0,t=i));let r=t[v.EXERCISE].length,c=t[v.PLANK].length,f=null;return[t,r,c,i=>{f=i.currentTarget,i.dataTransfer.effectAllowed="move"},i=>{i.preventDefault();const o=i.path.indexOf(f.parentNode);if(o<1)return;const p=i.path[o-1];if(f===p)return;const _=Array.from(f.parentNode.children);j.swapExercise(_.indexOf(f),_.indexOf(p),v.EXERCISE)},i=>{const o=i.currentTarget.dataset,p=parseInt(o.id);switch(o.action){case"up":case"down":j.swapExercise(p,p+(o.action=="down"?1:-1),o.type);break;case"delete":case"replace":j.alterExercise(p,o.type,o.action);break}},(i,o)=>{const p=i.type===v.PLANK?c>1:r>1,_=i.type===v.PLANK?!1:r>1,u={"data-id":o,"data-type":i.type};return[{icon:"bi bi-arrow-repeat",title:"Replace Exercise",disabled:!1,data:Object.assign({"data-action":"replace"},u)},{icon:"bi bi-arrow-up-circle",title:"Move Up",disabled:!p,data:Object.assign({"data-action":"up"},u)},{icon:"bi bi-arrow-down-circle",title:"Move Down",disabled:!p,data:Object.assign({"data-action":"down"},u)},{icon:"bi bi-trash",title:"Trash",disabled:!_,data:Object.assign({"data-action":"delete"},u)}]}]}class it extends U{constructor(e){super();G(this,e,ot,lt,J,{})}}function je(s){let e,n,t,r,c,f,m,l,a,d,i;return e=new ve({props:{click:s[4],$$slots:{default:[ct]},$$scope:{ctx:s}}}),r=new Ee({props:{buttons:s[5]()}}),r.$on("click",s[3]),m=new it({}),a=new ve({props:{click:s[4],$$slots:{default:[ut]},$$scope:{ctx:s}}}),{c(){n=L("div"),I(e.$$.fragment),t=N(),c=L("div"),I(r.$$.fragment),f=N(),I(m.$$.fragment),l=N(),d=L("div"),I(a.$$.fragment),this.h()},l(o){n=R(o,"DIV",{style:!0});var p=D(n);y(e.$$.fragment,p),t=C(o),c=R(o,"DIV",{style:!0});var _=D(c);y(r.$$.fragment,_),f=C(o),y(m.$$.fragment,o),l=C(o),d=R(o,"DIV",{style:!0});var u=D(d);y(a.$$.fragment,u),this.h()},h(){x(n,"display","contents"),x(n,"--theme-icon-size",".4rem"),x(c,"display","contents"),x(c,"--theme-icon-size","1.6rem"),x(d,"display","contents"),x(d,"--theme-icon-size",".3rem")},m(o,p){S(o,n,p),A(e,n,null),S(o,t,p),S(o,c,p),A(r,c,null),S(o,f,p),A(m,o,p),S(o,l,p),S(o,d,p),A(a,d,null),i=!0},p(o,p){const _={};p&8194&&(_.$$scope={dirty:p,ctx:o}),e.$set(_);const u={};p&8194&&(u.$$scope={dirty:p,ctx:o}),a.$set(u)},i(o){i||(E(e.$$.fragment,o),E(r.$$.fragment,o),E(m.$$.fragment,o),E(a.$$.fragment,o),i=!0)},o(o){w(e.$$.fragment,o),w(r.$$.fragment,o),w(m.$$.fragment,o),w(a.$$.fragment,o),i=!1},d(o){o&&h(n),O(e,o),o&&h(t),o&&h(c),O(r,o),o&&h(f),O(m,o),o&&h(l),o&&h(d),O(a,o)}}}function ct(s){let e,n;return e=new we({props:{label:"Total Time",value:ee(j.getTotalTime(s[1]))}}),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&2&&(c.value=ee(j.getTotalTime(t[1]))),e.$set(c)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ut(s){let e,n;return e=new we({props:{label:"Total Time",value:ee(j.getTotalTime(s[1]))}}),{c(){I(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,r){A(e,t,r),n=!0},p(t,r){const c={};r&2&&(c.value=ee(j.getTotalTime(t[1]))),e.$set(c)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function ft(s){let e,n,t,r,c,f;e=new ge({props:{title:""+((s[1].meta.title?s[1].meta.title:"Create")+" Workout")}}),t=new nt({props:{label:"Presets",name:"preset",value:s[1].meta.id,options:s[2].map(Pe)}}),t.$on("change",s[7]),t.$on("open",s[8]);let m=!s[0]&&s[1].exercises.length&&je(s);return{c(){I(e.$$.fragment),n=N(),I(t.$$.fragment),r=N(),m&&m.c(),c=W()},l(l){y(e.$$.fragment,l),n=C(l),y(t.$$.fragment,l),r=C(l),m&&m.l(l),c=W()},m(l,a){A(e,l,a),S(l,n,a),A(t,l,a),S(l,r,a),m&&m.m(l,a),S(l,c,a),f=!0},p(l,[a]){const d={};a&2&&(d.title=""+((l[1].meta.title?l[1].meta.title:"Create")+" Workout")),e.$set(d);const i={};a&2&&(i.value=l[1].meta.id),a&4&&(i.options=l[2].map(Pe)),t.$set(i),!l[0]&&l[1].exercises.length?m?(m.p(l,a),a&3&&E(m,1)):(m=je(l),m.c(),E(m,1),m.m(c.parentNode,c)):m&&(re(),w(m,1,1,()=>{m=null}),ae())},i(l){f||(E(e.$$.fragment,l),E(t.$$.fragment,l),E(m),f=!0)},o(l){w(e.$$.fragment,l),w(t.$$.fragment,l),w(m),f=!1},d(l){O(e,l),l&&h(n),O(t,l),l&&h(r),m&&m.d(l),l&&h(c)}}}const Pe=s=>[s.get("id"),s.get("title")];function mt(s,e,n){let t,r;V(s,j,u=>n(1,t=u)),V(s,Ge,u=>n(2,r=u));let c,{settingsOpen:f}=e;const m=me();be.routine;const l=u=>{switch(u.currentTarget.dataset.action){case"reset":j.preset=j.preset;break;case"share":d();break;case"settings_open":n(6,f=!0);break}},a=()=>"share"in window.navigator&&window.navigator.canShare(),d=async()=>{j.save(!0);const u={title:`Sweat ${t.meta.title} Workout`,text:"Here's the link to your saved workout.",url:"https://github.com"};a()?window.navigator.share(u).catch(b=>{console.error(b)}):navigator.clipboard&&navigator.clipboard.writeText(u.url).then(()=>{console.info("Show copied notification here")}).catch(b=>{console.error(b)})},i=()=>{j.save(!1),m("workout")},o=()=>[{icon:"bi bi-bootstrap-reboot",title:"Reset",data:{"data-action":"reset"}},{component:Me,props:{}},{icon:`bi bi-${a()?"share-fill":"link"}`,title:"Share",data:{"data-action":"share"}},{icon:"bi bi-gear-wide-connected",title:"Timer Settings",data:{"data-action":"settings_open"}}],p=u=>j.preset=r.find(b=>b.get("id")==u.detail),_=u=>n(0,c=u.detail);return s.$$set=u=>{"settingsOpen"in u&&n(6,f=u.settingsOpen)},[c,t,r,l,i,o,f,p,_]}class pt extends U{constructor(e){super();G(this,e,mt,ft,J,{settingsOpen:6})}}function _t(s){let e,n,t,r,c,f,m,l;return{c(){e=L("h2"),n=Y("Unable to connect to database"),t=N(),r=L("p"),c=Y("This is embarrassing! I'm unable to connect to the database."),f=N(),m=L("p"),l=Y("Please try again later. Sorry!"),this.h()},l(a){e=R(a,"H2",{class:!0});var d=D(e);n=Q(d,"Unable to connect to database"),d.forEach(h),t=C(a),r=R(a,"P",{});var i=D(r);c=Q(i,"This is embarrassing! I'm unable to connect to the database."),i.forEach(h),f=C(a),m=R(a,"P",{});var o=D(m);l=Q(o,"Please try again later. Sorry!"),o.forEach(h),this.h()},h(){T(e,"class","center error")},m(a,d){S(a,e,d),X(e,n),S(a,t,d),S(a,r,d),X(r,c),S(a,f,d),S(a,m,d),X(m,l)},p:se,i:se,o:se,d(a){a&&h(e),a&&h(t),a&&h(r),a&&h(f),a&&h(m)}}}function dt(s){let e,n,t,r;const c=[gt,bt],f=[];function m(l,a){return l[0]?0:1}return e=m(s),n=f[e]=c[e](s),{c(){n.c(),t=W()},l(l){n.l(l),t=W()},m(l,a){f[e].m(l,a),S(l,t,a),r=!0},p(l,a){let d=e;e=m(l),e===d?f[e].p(l,a):(re(),w(f[d],1,1,()=>{f[d]=null}),ae(),n=f[e],n?n.p(l,a):(n=f[e]=c[e](l),n.c()),E(n,1),n.m(t.parentNode,t))},i(l){r||(E(n),r=!0)},o(l){w(n),r=!1},d(l){f[e].d(l),l&&h(t)}}}function bt(s){let e,n,t;function r(f){s[6](f)}let c={};return s[0]!==void 0&&(c.settingsOpen=s[0]),e=new pt({props:c}),pe.push(()=>_e(e,"settingsOpen",r)),e.$on("workout",s[3]),{c(){I(e.$$.fragment)},l(f){y(e.$$.fragment,f)},m(f,m){A(e,f,m),t=!0},p(f,m){const l={};!n&&m&1&&(n=!0,l.settingsOpen=f[0],de(()=>n=!1)),e.$set(l)},i(f){t||(E(e.$$.fragment,f),t=!0)},o(f){w(e.$$.fragment,f),t=!1},d(f){O(e,f)}}}function gt(s){let e,n,t,r,c;e=new ge({props:{title:"Customize Workout"}});function f(l){s[5](l)}let m={};return s[0]!==void 0&&(m.open=s[0]),t=new xe({props:m}),pe.push(()=>_e(t,"open",f)),{c(){I(e.$$.fragment),n=N(),I(t.$$.fragment)},l(l){y(e.$$.fragment,l),n=C(l),y(t.$$.fragment,l)},m(l,a){A(e,l,a),S(l,n,a),A(t,l,a),c=!0},p(l,a){const d={};!r&&a&1&&(r=!0,d.open=l[0],de(()=>r=!1)),t.$set(d)},i(l){c||(E(e.$$.fragment,l),E(t.$$.fragment,l),c=!0)},o(l){w(e.$$.fragment,l),w(t.$$.fragment,l),c=!1},d(l){O(e,l),l&&h(n),O(t,l)}}}function ht(s){let e,n,t,r,c;const f=[dt,_t],m=[];function l(a,d){return a[1]?0:1}return n=l(s),t=m[n]=f[n](s),{c(){e=N(),t.c(),r=W(),this.h()},l(a){De('[data-svelte="svelte-8h4qcl"]',document.head).forEach(h),e=C(a),t.l(a),r=W(),this.h()},h(){document.title="SWEAT Workout"},m(a,d){S(a,e,d),m[n].m(a,d),S(a,r,d),c=!0},p(a,[d]){let i=n;n=l(a),n===i?m[n].p(a,d):(re(),w(m[i],1,1,()=>{m[i]=null}),ae(),t=m[n],t?t.p(a,d):(t=m[n]=f[n](a),t.c()),E(t,1),t.m(r.parentNode,r))},i(a){c||(E(t),c=!0)},o(a){w(t),c=!1},d(a){a&&h(e),m[n].d(a),a&&h(r)}}}async function At({fetch:s}){const e={xml:null};let n=!1;if(M.subscribe(r=>{n=r!==null})(),!n){const r=await s("/data/workout_list.xml");r.ok&&(e.xml=await r.text())}return{props:e}}function kt(s,e,n){let t,r;V(s,M,i=>n(1,r=i));let{xml:c}=e;const f=be.routine;V(s,f,i=>n(7,t=i));const m=()=>{Be.setItem("routine",[]),qe(t.tabataLink)};c&&M.setDb(c);let l=!1;function a(i){l=i,n(0,l)}function d(i){l=i,n(0,l)}return s.$$set=i=>{"xml"in i&&n(4,c=i.xml)},[l,r,f,m,c,a,d]}class Ot extends U{constructor(e){super();G(this,e,kt,ht,J,{xml:4})}}export{Ot as default,At as load};
